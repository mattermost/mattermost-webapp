"use strict";(self.webpackChunk_mattermost_webapp=self.webpackChunk_mattermost_webapp||[]).push([[396],{36192:(e,t,a)=>{a.d(t,{Z:()=>c});var s=a(45697),n=a.n(s),o=a(67294),r=a(44012),i=a(73727),l=a(70767);class c extends o.PureComponent{static get propTypes(){return{team:n().object,siteName:n().string}}render(){const{team:e}=this.props,t=0===(null==e?void 0:e.delete_at);return o.createElement("div",{className:"backstage-navbar"},o.createElement(i.Link,{className:"backstage-navbar__back",to:"/".concat(t?this.props.team.name:"")},o.createElement(l.Z,null),o.createElement("span",null,t?o.createElement(r.Z,{id:"backstage_navbar.backToMattermost",defaultMessage:"Back to {siteName}",values:{siteName:this.props.siteName?this.props.siteName:this.props.team.name}}):o.createElement(r.Z,{id:"backstage_navbar.back",defaultMessage:"Back"}))))}}},21396:(e,t,a)=>{a.r(t),a.d(t,{default:()=>is}),a(33948);var s=a(14494),n=a(5977),o=a(12707),r=a(5596),i=a(22742),l=a(34111),c=a(33407),m=(a(19601),a(74916),a(4723),a(67294)),d=a(45697),u=a.n(d),p=(a(85827),a(97779)),h=a(71436),g=a(45341),b=a(3448),f=(a(2707),a(39346)),E=a(11850);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){v(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function v(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function y(e){return e.entities.integrations.incomingHooks}function N(e){return e.entities.integrations.outgoingHooks}function M(e){return e.entities.integrations.commands}function w(e){return e.entities.integrations.oauthApps}const C=(0,f.P1)("getAppsOAuthAppIDs",E.D8,(e=>e.entities.integrations.appsOAuthAppIDs),((e,t)=>e?t:[])),A=(0,f.P1)("getAppsBotIDs",E.D8,(e=>e.entities.integrations.appsBotIDs),((e,t)=>e?t:[]));(0,f.P1)("getOutgoingHooksInCurrentTeam",r.ev,N,((e,t)=>Object.values(t).filter((t=>t.team_id===e))));const O=(0,f.P1)("getAllCommands",M,(function(e){return e.entities.integrations.systemCommands}),((e,t)=>k(k({},e),t)));(0,f.P1)("getAutocompleteCommandsList",O,r.ev,((e,t)=>Object.values(e).filter((e=>e&&(!e.team_id||e.team_id===t)&&e.auto_complete)).sort(((e,t)=>e.display_name.localeCompare(t.display_name)))));var S=a(33383),T=(a(32023),a(91058),a(88674),a(44012)),Z=a(12266),R=a(31055),P=(a(64765),a(73727)),I=a(19476),x=a(30866);function j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class U extends m.PureComponent{constructor(e){super(e),j(this,"updateFilter",(e=>{this.setState({filter:e.target.value})})),this.state={filter:""}}render(){const e=this.state.filter.toLowerCase();let t;if(this.props.loading)t=m.createElement(I.Z,null);else{t=this.props.children;let a=!0;"function"==typeof t&&([t,a]=t(e)),t=m.Children.map(t,(t=>m.cloneElement(t,{filter:e}))),0!==t.length&&a||(e?this.props.emptyTextSearch&&(t=m.createElement("div",{className:"backstage-list__item backstage-list__empty",id:"emptySearchResultsMessage"},m.cloneElement(this.props.emptyTextSearch,{values:{searchTerm:e}}))):this.props.emptyText&&(t=m.createElement("div",{className:"backstage-list__item backstage-list__empty"},this.props.emptyText)))}let a=null;return this.props.addLink&&this.props.addText&&(a=m.createElement(P.Link,{className:"add-link",to:this.props.addLink},m.createElement("button",{type:"button",className:"btn btn-primary",id:this.props.addButtonId},m.createElement("span",null,this.props.addText)))),m.createElement("div",{className:"backstage-content"},m.createElement("div",{className:"backstage-header"},m.createElement("h1",null,this.props.header),a),m.createElement("div",{className:"backstage-filters"},m.createElement("div",{className:"backstage-filter__search"},m.createElement(x.Z,null),m.createElement("input",{type:"search",className:"form-control",placeholder:this.props.searchPlaceholder,value:this.state.filter,onChange:this.updateFilter,style:q.search,id:"searchInput"}))),m.createElement("span",{className:"backstage-list__help"},this.props.helpText),m.createElement("div",{className:"backstage-list"},t))}}j(U,"propTypes",{children:u().oneOfType([u().node,u().func]),header:u().node.isRequired,addLink:u().string,addText:u().node,addButtonId:u().string,emptyText:u().node,emptyTextSearch:u().node,helpText:u().node,loading:u().bool.isRequired,searchPlaceholder:u().string}),j(U,"defaultProps",{searchPlaceholder:R._u("backstage_list.search","Search")});const q={search:{flexGrow:0,flexShrink:0}};var D=a(66788),L=a(45288),W=(a(41817),a(32579)),H=a(64852),B=a(58657),F=a(37668);function G(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Y(e,t,a){if(!t)return!0;const s=e.username||"",n=e.description||"",o=e.display_name||"";let r="plugin";return a&&a.username&&(r=a.username),!(-1===s.toLowerCase().indexOf(t)&&-1===o.toLowerCase().indexOf(t)&&-1===n.toLowerCase().indexOf(t)&&-1===r.toLowerCase().indexOf(t))}class z extends m.PureComponent{constructor(e){super(e),G(this,"enableBot",(()=>{this.props.actions.enableBot(this.props.bot.user_id)})),G(this,"disableBot",(()=>{this.props.actions.disableBot(this.props.bot.user_id)})),G(this,"enableUserAccessToken",(e=>{this.props.actions.enableUserAccessToken(e)})),G(this,"disableUserAccessToken",(e=>{this.props.actions.disableUserAccessToken(e)})),G(this,"confirmRevokeToken",(e=>{this.setState({confirmingId:e})})),G(this,"revokeTokenConfirmed",(()=>{this.props.actions.revokeUserAccessToken(this.state.confirmingId),this.closeConfirm()})),G(this,"closeConfirm",(()=>{this.setState({confirmingId:""})})),G(this,"openCreateToken",(()=>{this.setState({creatingTokenState:"OPEN",token:{description:""}})})),G(this,"closeCreateToken",(()=>{this.setState({creatingTokenState:"CLOSED",token:{description:""}})})),G(this,"handleUpdateDescription",(e=>{const t=e.target;this.setState({token:Object.assign({},this.state.token,{description:t.value})})})),G(this,"handleCreateToken",(async e=>{if(e.preventDefault(),""===this.state.token.description)return void this.setState({error:m.createElement(T.Z,{id:"bot.token.error.description",defaultMessage:"Please enter a description."})});const{data:t,error:a}=await this.props.actions.createUserAccessToken(this.props.bot.user_id,this.state.token.description);t?this.setState({creatingTokenState:"CREATED",token:t}):a&&this.setState({error:a.message})})),this.state={confirmingId:"",creatingTokenState:"CLOSED",token:{},error:""}}render(){const e=this.props.bot.username||"",t=this.props.bot.description||"",a=this.props.bot.display_name||"";let s="plugin";this.props.fromApp?s="Apps Framework":this.props.owner&&this.props.owner.username&&(s=this.props.owner.username);const n=this.props.filter?this.props.filter.toLowerCase():"";if(!Y(this.props.bot,n,this.props.owner))return null;const o=[];let r;Object.values(this.props.accessTokens).forEach((e=>{let t,a,s="";e.is_active?t=m.createElement("a",{id:e.id+"_deactivate",href:"#",onClick:t=>{t.preventDefault(),this.disableUserAccessToken(e.id)}},m.createElement(T.Z,{id:"user.settings.tokens.deactivate",defaultMessage:"Disable"})):(s="light",a=m.createElement("span",{className:"mr-2 light"},m.createElement(T.Z,{id:"user.settings.tokens.deactivatedWarning",defaultMessage:"(Disabled)"})),t=m.createElement("a",{id:e.id+"_activate",href:"#",onClick:t=>{t.preventDefault(),this.enableUserAccessToken(e.id)}},m.createElement(T.Z,{id:"user.settings.tokens.activate",defaultMessage:"Enable"}))),o.push(m.createElement("div",{key:e.id,className:"bot-list__item"},m.createElement("div",{className:"item-details__row d-flex justify-content-between"},m.createElement("div",{className:s},m.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},m.createElement("b",null,m.createElement(T.Z,{id:"user.settings.tokens.tokenDesc",defaultMessage:"Token Description: "})),e.description),m.createElement("div",{className:"setting-box__token-id whitespace--nowrap overflow--ellipsis"},m.createElement("b",null,m.createElement(T.Z,{id:"user.settings.tokens.tokenId",defaultMessage:"Token ID: "})),e.id)),m.createElement("div",null,a,t," - ",m.createElement("a",{id:e.id+"_delete",href:"#",onClick:t=>{t.preventDefault(),this.confirmRevokeToken(e.id)}},m.createElement(T.Z,{id:"user.settings.tokens.delete",defaultMessage:"Delete"}))))))})),"plugin"!==s&&(r=m.createElement("div",{className:"item-actions"},m.createElement("button",{id:"createToken",className:"style--none color--link",onClick:this.openCreateToken},m.createElement(T.Z,{id:"bot.manage.create_token",defaultMessage:"Create New Token"}))," - ",m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/bots/edit?id=").concat(this.props.bot.user_id)},m.createElement(T.Z,{id:"bots.manage.edit",defaultMessage:"Edit"}))," - ",m.createElement("button",{className:"style--none color--link",onClick:this.disableBot},m.createElement(T.Z,{id:"bot.manage.disable",defaultMessage:"Disable"})))),0!==this.props.bot.delete_at&&(r=m.createElement("div",{className:"item-actions"},m.createElement("button",{className:"style--none color--link",onClick:this.enableBot},m.createElement(T.Z,{id:"bot.manage.enable",defaultMessage:"Enable"})))),"OPEN"===this.state.creatingTokenState?o.push(m.createElement("div",{key:"create",className:"bot-list__item"},m.createElement("div",{key:"create"},m.createElement("form",{className:"form-horizontal",onSubmit:this.handleCreateToken},m.createElement("div",{className:"row"},m.createElement("label",{className:"col-sm-auto control-label"},m.createElement(T.Z,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "})),m.createElement("div",{className:"col-sm-4"},m.createElement("input",{autoFocus:!0,className:"form-control form-sm",type:"text",maxLength:64,value:this.state.token.description,onChange:this.handleUpdateDescription}))),m.createElement("div",null,m.createElement("div",{className:"pt-2 pb-2"},m.createElement(T.Z,{id:"user.settings.tokens.nameHelp",defaultMessage:"Enter a description for your token to remember what it does."})),m.createElement("label",{id:"clientError",className:"has-error is-empty"},this.state.error),m.createElement("div",{className:"mt-2"},m.createElement(B.Z,{btnClass:"btn-sm btn-primary",savingMessage:m.createElement(T.Z,{id:"user.settings.tokens.save",defaultMessage:"Save"}),saving:!1}),m.createElement("button",{className:"btn btn-sm btn-link",onClick:this.closeCreateToken},m.createElement(T.Z,{id:"user.settings.tokens.cancel",defaultMessage:"Cancel"})))))))):"CREATED"===this.state.creatingTokenState&&o.push(m.createElement("div",{key:"created",className:"bot-list__item alert alert-warning"},m.createElement("div",{className:"mb-2"},m.createElement(F.Z,{additionalClassName:"mr-2"}),m.createElement(T.Z,{id:"user.settings.tokens.copy",defaultMessage:"Please copy the access token below. You won't be able to see it again!"})),m.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},m.createElement(T.Z,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "}),this.state.token.description),m.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},m.createElement(T.Z,{id:"user.settings.tokens.id",defaultMessage:"Token ID: "}),this.state.token.id),m.createElement("strong",{className:"word-break--all"},m.createElement(T.Z,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),this.state.token.token),m.createElement("div",{className:"mt-2"},m.createElement("button",{className:"btn btn-sm btn-primary",onClick:this.closeCreateToken},m.createElement(T.Z,{id:"bot.create_token.close",defaultMessage:"Close"})))));const i=R.bb(this.props.user.id,this.props.user.last_picture_update);return m.createElement("div",{className:"backstage-list__item"},m.createElement("div",{className:"bot-list-img-container"},m.createElement("img",{className:"bot-list-img",alt:"bot image",src:i})),m.createElement("div",{className:"item-details"},m.createElement("div",{className:"item-details__row d-flex flex-column flex-md-row justify-content-between"},m.createElement("strong",{className:"item-details__name"},a+" (@"+e+")"),r),m.createElement("div",{className:"bot-details__description"},m.createElement(H.Z,{message:t})),m.createElement("div",{className:"light small"},m.createElement(T.Z,{id:"bots.managed_by",defaultMessage:"Managed by "}),s),m.createElement("div",{className:"bot-list is-empty"},o)),m.createElement(W.Z,{title:m.createElement(T.Z,{id:"bots.token.delete",defaultMessage:"Delete Token"}),message:m.createElement(T.Z,{id:"bots.token.confirm_text",defaultMessage:"Are you sure you want to delete the token?"}),confirmButtonText:m.createElement(T.Z,{id:"bots.token.confirm",defaultMessage:"Delete"}),show:""!==this.state.confirmingId,onConfirm:this.revokeTokenConfirmed,onCancel:this.closeConfirm}))}}function J(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}G(z,"propTypes",{filter:u().string,fromApp:u().bool.isRequired,actions:u().shape({disableBot:u().func.isRequired,enableBot:u().func.isRequired,createUserAccessToken:u().func.isRequired,revokeUserAccessToken:u().func.isRequired,enableUserAccessToken:u().func.isRequired,disableUserAccessToken:u().func.isRequired}).isRequired});class V extends m.PureComponent{constructor(e){super(e),J(this,"botToJSX",(e=>m.createElement(z,{key:e.user_id,bot:e,owner:this.props.owners[e.user_id],user:this.props.users[e.user_id],accessTokens:this.props.accessTokens&&this.props.accessTokens[e.user_id]||{},actions:this.props.actions,team:this.props.team,fromApp:this.props.appsBotIDs.includes(e.user_id)}))),J(this,"bots",(e=>{const t=Object.values(this.props.bots).sort(((e,t)=>e.username.localeCompare(t.username))),a=t=>Y(t,e,this.props.owners[t.user_id]),s=t.filter((e=>0===e.delete_at)).filter(a).map(this.botToJSX),n=t.filter((e=>e.delete_at>0)).filter(a).map(this.botToJSX);return[m.createElement("div",{key:"sections"},m.createElement(this.EnabledSection,{enabledBots:s}),m.createElement(this.DisabledSection,{hasDisabled:n.length>0,disabledBots:n})),s.length>0||n.length>0]})),this.state={loading:!0}}componentDidMount(){this.props.actions.loadBots(D.ZP.Integrations.START_PAGE_NUM,parseInt(D.ZP.Integrations.PAGE_SIZE,10)).then((e=>{if(e.data){const t=[];for(const a of e.data)this.props.actions.getUser(a.owner_id),t.push(this.props.actions.getUser(a.user_id)),t.push(this.props.actions.getUserAccessTokensForUser(a.user_id));Promise.all(t).then((()=>{this.setState({loading:!1})}))}})),this.props.appsEnabled&&this.props.actions.fetchAppsBotIDs()}DisabledSection(e){if(!e.hasDisabled)return null;const t=m.Children.map(e.disabledBots,(t=>m.cloneElement(t,{filter:e.filter})));return m.createElement(m.Fragment,null,m.createElement("div",{className:"bot-disabled"},m.createElement(T.Z,{id:"bots.disabled",defaultMessage:"Disabled"})),m.createElement("div",{className:"bot-list__disabled"},t))}EnabledSection(e){const t=m.Children.map(e.enabledBots,(t=>m.cloneElement(t,{filter:e.filter})));return m.createElement("div",null,t)}render(){return m.createElement(U,{header:m.createElement(T.Z,{id:"bots.manage.header",defaultMessage:"Bot Accounts"}),addText:this.props.createBots&&m.createElement(T.Z,{id:"bots.manage.add",defaultMessage:"Add Bot Account"}),addLink:"/"+this.props.team.name+"/integrations/bots/add",addButtonId:"addBotAccount",emptyText:m.createElement(T.Z,{id:"bots.manage.empty",defaultMessage:"No bot accounts found"}),emptyTextSearch:m.createElement(L.Z,{id:"bots.manage.emptySearch",defaultMessage:"No bot accounts match **{searchTerm}**"}),helpText:m.createElement(m.Fragment,null,m.createElement(T.Z,{id:"bots.manage.help1",defaultMessage:"Use {botAccounts} to integrate with Mattermost through plugins or the API. Bot accounts are available to everyone on your server. ",values:{botAccounts:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mattermost.com/pl/default-bot-accounts"},m.createElement(T.Z,{id:"bots.manage.bot_accounts",defaultMessage:"Bot Accounts"}))}}),m.createElement(L.Z,{id:"bots.manage.help2",defaultMessage:"Enable bot account creation in the [System Console]({siteURL}/admin_console/integrations/bot_accounts).",values:{siteURL:(0,Z.fO)()}})),searchPlaceholder:R._u("bots.manage.search","Search Bot Accounts"),loading:this.state.loading},this.bots)}}J(V,"propTypes",{appsBotIDs:u().arrayOf(u().string).isRequired,appsEnabled:u().bool.isRequired,createBots:u().bool,actions:u().shape({loadBots:u().func.isRequired,getUserAccessTokensForUser:u().func.isRequired,createUserAccessToken:u().func.isRequired,revokeUserAccessToken:u().func.isRequired,enableUserAccessToken:u().func.isRequired,disableUserAccessToken:u().func.isRequired,getUser:u().func.isRequired,disableBot:u().func.isRequired,enableBot:u().func.isRequired,fetchAppsBotIDs:u().func.isRequired}).isRequired});const K=(0,s.connect)((function(e){const t="true"===(0,i.iE)(e).EnableBotAccountCreation,a=(0,h.Zh)(e),s=Object.values(a),n=s.reduce(((t,a)=>(t[a.user_id]=o.PR(e,a.owner_id),t)),{}),r=s.reduce(((t,a)=>(t[a.user_id]=o.PR(e,a.user_id),t)),{});return{createBots:t,bots:a,accessTokens:e.entities.admin.userAccessTokensByUser,owners:n,users:r,appsBotIDs:A(e),appsEnabled:(0,E.D8)(e)}}),(function(e){return{actions:(0,p.bindActionCreators)({fetchAppsBotIDs:b.J4,loadBots:g.l5,getUserAccessTokensForUser:S.fh,createUserAccessToken:S.CR,revokeUserAccessToken:S.ei,enableUserAccessToken:S.q9,disableUserAccessToken:S.Wv,getUser:S.PR,disableBot:g.Uc,enableBot:g.PZ},e)}}))(V);a(41637),a(60285),a(73210);var X=a(81540),Q=a(60690);const $=a.p+"files/f6e98d6b5fccaa0c93bd8091b05295ad.png";var ee,te,ae,se=a(89262),ne=a(68492),oe=a(82251);class re extends m.PureComponent{render(){const e=[];return m.Children.forEach(this.props.children,((t,a)=>{0!==a&&e.push(m.createElement("span",{key:"divider"+a,className:"backstage-header__divider"},m.createElement(ne.Z,{className:"fa fa-angle-right",title:{id:(0,oe.t)("generic_icons.breadcrumb"),defaultMessage:"Breadcrumb Icon"}}))),e.push(t)})),m.createElement("div",{className:"backstage-header"},m.createElement("h1",null,e))}}ee=re,te="propTypes",ae={children:u().node},te in ee?Object.defineProperty(ee,te,{value:ae,enumerable:!0,configurable:!0,writable:!0}):ee[te]=ae;var ie=a(15558),le=a(89959),ce=a(77555),me=a(95795);function de(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const ue="System Admin",pe="Member";class he extends m.PureComponent{constructor(e){super(e),de(this,"updateUsername",(e=>{this.setState({username:e.target.value})})),de(this,"updateDisplayName",(e=>{this.setState({displayName:e.target.value})})),de(this,"updateDescription",(e=>{this.setState({description:e.target.value})})),de(this,"updateRole",(e=>{this.setState({role:e.target.value})})),de(this,"updatePostAll",(e=>{this.setState({postAll:e.target.checked})})),de(this,"updatePostChannels",(e=>{this.setState({postChannels:e.target.checked})})),de(this,"updatePicture",(e=>{if(e.target.files&&e.target.files[0]){const a=e.target.files[0];this.previewBlob=URL.createObjectURL(a);var t=new FileReader;t.onload=e=>{const t=X.Ii(e.target.result),a=X.vl(t);this.setState({image:this.previewBlob,orientationStyles:a})},t.readAsArrayBuffer(a),e.target.value=null,this.setState({pictureFile:a})}else this.setState({pictureFile:null,image:null})})),de(this,"setDefault",(()=>{this.setState({pictureFile:"default",image:$})})),de(this,"updateRoles",(async e=>{let t=c.LQ.SYSTEM_USER_ROLE;this.state.role===ue?t+=" "+c.LQ.SYSTEM_ADMIN_ROLE:this.state.postAll?t+=" "+c.LQ.SYSTEM_POST_ALL_ROLE:this.state.postChannels&&(t+=" "+c.LQ.SYSTEM_POST_ALL_PUBLIC_ROLE);const a=await this.props.actions.updateUserRoles(e.user_id,t);return a?a.error:null})),de(this,"handleSubmit",(async e=>{if(e.preventDefault(),this.state.adding)return;if(!this.state.username||this.state.username.length<3)return void this.setState({error:m.createElement(T.Z,{id:"bots.manage.add.invalid_username",defaultMessage:"Usernames have to begin with a lowercase letter and be 3-22 characters long. You can use lowercase letters, numbers, periods, dashes, and underscores."})});this.state.pictureFile&&(D.Ec.includes(this.state.pictureFile.type)?this.state.pictureFile.size>this.props.maxFileSize&&this.setState({error:m.createElement(T.Z,{id:"user.settings.general.imageTooLarge",defaultMessage:"Unable to upload profile image. File is too large."})}):this.setState({error:m.createElement(T.Z,{id:"user.settings.general.validImage",defaultMessage:"Only BMP, JPG or PNG images may be used for profile pictures"})})),this.setState({adding:!0,error:""});const t={username:this.state.username.toLowerCase().trim(),display_name:this.state.displayName,description:this.state.description};let a,s;if(this.props.bot){const e=await this.props.actions.patchBot(this.props.bot.user_id,t);if(e?(a=e.data,s=e.error):s=R._u("bot.edit_failed","Failed to edit bot"),s||(this.state.pictureFile&&"default"!==this.state.pictureFile?s=(await this.props.actions.uploadProfileImage(a.user_id,this.state.pictureFile)).error:this.state.pictureFile&&"default"===this.state.pictureFile&&await this.props.actions.setDefaultProfileImage(a.user_id)),!s&&a&&(s=this.updateRoles(a)),a)return void se.m.push("/".concat(this.props.team.name,"/integrations/bots"))}else{const e=R.LH(t.username);if(e){let t;return t=e.id===D.qf.INVALID_LAST_CHARACTER?{adding:!1,error:m.createElement(T.Z,{id:"bots.manage.add.invalid_last_char",defaultMessage:"Bot usernames cannot have a period as the last character"})}:{adding:!1,error:m.createElement(T.Z,{id:"bots.manage.add.invalid_username",defaultMessage:"Usernames must begin with a lowercase letter and be 3-22 characters long. You can use lowercase letters, numbers, periods, dashes, and underscores."})},void this.setState(t)}const n=await this.props.actions.createBot(t);n?(a=n.data,s=n.error):s=R._u("bot.create_failed","Failed to create bot");let o="";if(!s){this.state.pictureFile&&"default"!==this.state.pictureFile?await this.props.actions.uploadProfileImage(a.user_id,this.state.pictureFile):await this.props.actions.setDefaultProfileImage(a.user_id);const e=await this.props.actions.createUserAccessToken(a.user_id,R._u("bot.token.default.description","Default Token"));if(!e||e.error)return void se.m.push("/".concat(this.props.team.name,"/integrations/bots"));o=e.data.token}if(!s&&a&&(s=this.updateRoles(a)),a)return void se.m.push("/".concat(this.props.team.name,"/integrations/confirm?type=bots&id=").concat(a.user_id,"&token=").concat(o))}this.setState({adding:!1}),s&&this.setState({error:s.message})})),this.state={error:"",username:"",displayName:"",description:"",adding:!1,image:$,role:pe,postAll:!1,postChannels:!1},this.props.bot&&(this.state.username=this.props.bot.username,this.state.displayName=this.props.bot.display_name,this.state.description=this.props.bot.description,this.state.role=Q.$O(this.props.roles||"")?ue:pe,this.state.postAll=Q.dB(this.props.roles||""),this.state.postChannels=Q.fG(this.props.roles||""))}render(){let e=m.createElement(T.Z,{id:"bots.manage.add",defaultMessage:"Add"}),t=m.createElement(T.Z,{id:"bots.manage.add.create",defaultMessage:"Create Bot Account"}),a=m.createElement(T.Z,{id:"bots.manage.add.creating",defaultMessage:"Creating..."});this.props.bot&&(e=m.createElement(T.Z,{id:"bots.manage.edit",defaultMessage:"Edit"}),t=m.createElement(T.Z,{id:"bots.manage.edit.title",defaultMessage:"Update"}),a=m.createElement(T.Z,{id:"bots.manage.edit.editing",defaultMessage:"Updating..."}));let s="",n=m.createElement(ie.Z,{delayShow:D.gT.OVERLAY_TIME_DELAY,placement:"right",overlay:m.createElement(le.Z,{id:"removeIcon"},m.createElement(T.Z,{id:"bot.remove_profile_picture",defaultMessage:"Remove Bot Icon"}))},m.createElement("a",{className:"bot-profile__remove",onClick:this.setDefault},m.createElement("span",null,"Ã—"))),o=null;return this.props.bot&&!this.state.pictureFile?s=this.props.user?R.bb(this.props.user.id,this.props.user.last_picture_update):R.bb(this.props.bot.user_id):(s=this.state.image,o=this.state.orientationStyles,this.state.image===$&&(n=null)),m.createElement("div",{className:"backstage-content"},m.createElement(re,null,m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/bots")},m.createElement(T.Z,{id:"bots.manage.header",defaultMessage:"Bot Accounts"})),e),m.createElement("div",{className:"backstage-form"},m.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},m.createElement(T.Z,{id:"bots.add.username",defaultMessage:"Username"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"username",type:"text",maxLength:"22",className:"form-control",value:this.state.username,onChange:this.updateUsername}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"bot.add.username.help",defaultMessage:"You can use lowercase letters, numbers, periods, dashes, and underscores."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"boticon"},m.createElement(T.Z,{id:"bots.add.icon",defaultMessage:"Bot Icon"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("div",{className:"bot-img-container"},m.createElement("img",{className:"bot-img",alt:"bot image",src:s,style:o}),n),m.createElement("div",{className:"btn btn-sm btn-primary btn-file sel-btn"},m.createElement(T.Z,{id:"bots.image.upload",defaultMessage:"Upload Image"}),m.createElement("input",{accept:D.gT.ACCEPT_STATIC_IMAGE,type:"file",onChange:this.updatePicture})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},m.createElement(T.Z,{id:"bots.add.displayName",defaultMessage:"Display Name"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"bot.add.display_name.help",defaultMessage:"(Optional) You can choose to display your bot's full name rather than its username."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.createElement(T.Z,{id:"bot.add.description",defaultMessage:"Description"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"description",type:"text",maxLength:"1024",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"bot.add.description.help",defaultMessage:"(Optional) Let others know what this bot does."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"role"},m.createElement(T.Z,{id:"bot.add.role",defaultMessage:"Role"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("select",{className:"form-control",value:this.state.role,disabled:!this.props.editingUserHasManageSystem,onChange:this.updateRole},m.createElement("option",{value:pe},R._u("bot.add.role.member","Member")),m.createElement("option",{value:ue},R._u("bot.add.role.admin","System Admin"))),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"bot.add.role.help",defaultMessage:"Choose what role the bot should have."})))),m.createElement("div",{className:"row bot-profile__section"},m.createElement("div",{className:"col-md-5 col-sm-8 col-sm-offset-4"},m.createElement(L.Z,{id:"admin.manage_roles.additionalRoles",defaultMessage:"Select additional permissions for the account. [Read more about roles and permissions](!https://developers.mattermost.com/integrate/admin-guide/admin-personal-access-token/)."}))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"postAll"},m.createElement(T.Z,{id:"bot.add.post_all",defaultMessage:"post:all"})),m.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},m.createElement("div",{className:"checkbox no-padding"},m.createElement("label",{htmlFor:"postAll"},m.createElement("input",{id:"postAll",type:"checkbox",checked:this.state.postAll||this.state.role===ue,onChange:this.updatePostAll,disabled:!this.props.editingUserHasManageSystem||this.state.role===ue}),m.createElement(T.Z,{id:"bot.add.post_all.enabled",defaultMessage:"Enabled"}))),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"bot.add.post_all.help",defaultMessage:"Bot will have access to post to all Mattermost channels including direct messages."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"postChannels"},m.createElement(T.Z,{id:"bot.add.post_channels",defaultMessage:"post:channels"})),m.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},m.createElement("div",{className:"checkbox no-padding"},m.createElement("label",{htmlFor:"postChannels"},m.createElement("input",{id:"postChannels",type:"checkbox",checked:this.state.postChannels||this.state.role===ue||this.state.postAll,onChange:this.updatePostChannels,disabled:!this.props.editingUserHasManageSystem||this.state.role===ue||this.state.postAll}),m.createElement(T.Z,{id:"bot.add.post_channels.enabled",defaultMessage:"Enabled"}))),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"bot.add.post_channels.help",defaultMessage:"Bot will have access to post to all Mattermost public channels."})))),m.createElement("div",{className:"backstage-form__footer"},m.createElement(me.Z,{type:"backstage",errors:[this.state.error]}),m.createElement(P.Link,{className:"btn btn-link btn-sm",to:"/".concat(this.props.team.name,"/integrations/bots")},m.createElement(T.Z,{id:"bots.manage.add.cancel",defaultMessage:"Cancel"})),m.createElement(ce.Z,{className:"btn btn-primary",type:"submit",spinning:this.state.adding,spinningText:a,onClick:this.handleSubmit,id:"saveBot"},t)))))}}de(he,"propTypes",{team:u().object.isRequired,bot:u().object,user:u().object,roles:u().string,maxFileSize:u().number.isRequired,editingUserHasManageSystem:u().bool.isRequired,actions:u().shape({createBot:u().func.isRequired,patchBot:u().func.isRequired,uploadProfileImage:u().func.isRequired,setDefaultProfileImage:u().func.isRequired,createUserAccessToken:u().func.isRequired,updateUserRoles:u().func.isRequired})});const ge=(0,s.connect)((function(e,t){const a=(0,i.iE)(e),s=new URLSearchParams(t.location.search).get("id"),n=(0,h.Gb)(e),r=n?n[s]:null,m=r?(0,o.PR)(e,r.user_id):null,d=m?m.roles:null;return{maxFileSize:parseInt(a.MaxFileSize,10),bot:r,roles:d,editingUserHasManageSystem:(0,l.AN)(e,{permission:c.Pl.MANAGE_SYSTEM}),user:m}}),(function(e){return{actions:(0,p.bindActionCreators)({createBot:g.lz,patchBot:g.XI,uploadProfileImage:S._p,setDefaultProfileImage:S.QJ,createUserAccessToken:S.CR,updateUserRoles:S.hB},e)}}))(he);var be=a(62986),fe=a(35897),Ee=a(21440);const _e=a.p+"files/357ed0208b2f0eab27a2b67d4b5f129c.jpg",ke=a.p+"files/445dd2ab20befc4a78c9e77bc9fd260f.png",ve=a.p+"files/4651fd92bdc643485b9edc86e79e02e7.jpg",ye=a.p+"files/8a9816ae9c0cd846ae780433ccb979f0.jpg";var Ne=a(36846),Me=a(33574);class we extends m.PureComponent{static get propTypes(){return{image:u().string.isRequired,title:u().node.isRequired,description:u().node.isRequired,link:u().string.isRequired}}render(){const{image:e,title:t,description:a,link:s}=this.props;return m.createElement(P.Link,{to:s,className:"integration-option"},m.createElement("img",{alt:"integration image",className:"integration-option__image",src:e}),m.createElement("div",{className:"integration-option__title"},t),m.createElement("div",{className:"integration-option__description"},a))}}class Ce extends m.PureComponent{constructor(){super(...arguments),function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(this,"updateTitle",(()=>{const e=this.props.siteName||"";document.title=R._u("admin.sidebar.integrations","Integrations")+" - "+this.props.team.display_name+" "+e}))}static get propTypes(){return{team:u().object,user:u().object,siteName:u().string,enableIncomingWebhooks:u().bool,enableOutgoingWebhooks:u().bool,enableCommands:u().bool,enableOAuthServiceProvider:u().bool}}componentDidMount(){this.updateTitle()}render(){const e=[];return this.props.enableIncomingWebhooks&&e.push(m.createElement(Me.Z,{teamId:this.props.team.id,permissions:[c.Pl.MANAGE_INCOMING_WEBHOOKS],key:"incomingWebhookPermission"},m.createElement(we,{key:"incomingWebhook",image:_e,title:m.createElement(T.Z,{id:"integrations.incomingWebhook.title",defaultMessage:"Incoming Webhooks"}),description:m.createElement(T.Z,{id:"integrations.incomingWebhook.description",defaultMessage:"Incoming webhooks allow external integrations to send messages"}),link:"/"+this.props.team.name+"/integrations/incoming_webhooks"}))),this.props.enableOutgoingWebhooks&&e.push(m.createElement(Me.Z,{teamId:this.props.team.id,permissions:[c.Pl.MANAGE_OUTGOING_WEBHOOKS],key:"outgoingWebhookPermission"},m.createElement(we,{key:"outgoingWebhook",image:ve,title:m.createElement(T.Z,{id:"integrations.outgoingWebhook.title",defaultMessage:"Outgoing Webhooks"}),description:m.createElement(T.Z,{id:"integrations.outgoingWebhook.description",defaultMessage:"Outgoing webhooks allow external integrations to receive and respond to messages"}),link:"/"+this.props.team.name+"/integrations/outgoing_webhooks"}))),this.props.enableCommands&&e.push(m.createElement(Me.Z,{teamId:this.props.team.id,permissions:[c.Pl.MANAGE_SLASH_COMMANDS],key:"commandPermission"},m.createElement(we,{key:"command",image:ye,title:m.createElement(T.Z,{id:"integrations.command.title",defaultMessage:"Slash Commands"}),description:m.createElement(T.Z,{id:"integrations.command.description",defaultMessage:"Slash commands send events to an external integration"}),link:"/"+this.props.team.name+"/integrations/commands"}))),this.props.enableOAuthServiceProvider&&e.push(m.createElement(Ne.Z,{permissions:[c.Pl.MANAGE_OAUTH],key:"oauth2AppsPermission"},m.createElement(we,{key:"oauth2Apps",image:ke,title:m.createElement(T.Z,{id:"integrations.oauthApps.title",defaultMessage:"OAuth 2.0 Applications"}),description:m.createElement(T.Z,{id:"integrations.oauthApps.description",defaultMessage:"Auth 2.0 allows external applications to make authorized requests to the Mattermost API"}),link:"/"+this.props.team.name+"/integrations/oauth2-apps"}))),e.push(m.createElement(Ne.Z,{permissions:["manage_bots"],key:"botsPermissions"},m.createElement(we,{image:$,title:m.createElement(T.Z,{id:"bots.manage.header",defaultMessage:"Bot Accounts"}),description:m.createElement(T.Z,{id:"bots.manage.description",defaultMessage:"Use bot accounts to integrate with Mattermost through plugins or the API"}),link:"/"+this.props.team.name+"/integrations/bots"}))),m.createElement("div",{className:"backstage-content row"},m.createElement("div",{className:"backstage-header"},m.createElement("h1",null,m.createElement(T.Z,{id:"integrations.header",defaultMessage:"Integrations"}))),m.createElement("div",{className:"backstage-list__help"},m.createElement(T.Z,{id:"integrations.help",defaultMessage:"Visit the {appDirectory} to find self-hosted, third-party apps and integrations for Mattermost.",values:{appDirectory:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mattermost.com/marketplace"},m.createElement(T.Z,{id:"integrations.help.appDirectory",defaultMessage:"App Directory"}))}})),m.createElement("div",{className:"integrations-list d-flex flex-wrap"},e))}}const Ae=(0,s.connect)((function(e){const t=(0,i.iE)(e);return{siteName:t.SiteName,enableIncomingWebhooks:"true"===t.EnableIncomingWebhooks,enableOutgoingWebhooks:"true"===t.EnableOutgoingWebhooks,enableCommands:"true"===t.EnableCommands,enableOAuthServiceProvider:"true"===t.EnableOAuthServiceProvider}}))(Ce);var Oe=a(74147),Se=a(25267),Te=a(26500),Ze=a(74327),Re=a(24377),Pe=a(53473),Ie=a(97486),xe=a(78289);function je(e){const{confirmButtonText:t=m.createElement(T.Z,{id:"integrations.delete.confirm.button",defaultMessage:"Delete"}),linkText:a=m.createElement(T.Z,{id:"installed_integrations.delete",defaultMessage:"Delete"}),modalMessage:s,modalTitle:n=m.createElement(T.Z,{id:"integrations.delete.confirm.title",defaultMessage:"Delete Integration"}),onDelete:o,openModal:r}=e,i=(0,m.useCallback)((()=>{r({modalId:"delete_integration_confirm",dialogProps:{confirmButtonText:t,message:m.createElement("div",{className:"alert alert-warning"},m.createElement(F.Z,{additionalClassName:"mr-1"}),e.modalMessage),onConfirm:o,title:n},dialogType:xe.Z})}),[t,s,n,o,r]);return m.createElement("button",{className:"color--link style--none",onClick:i},a)}je.propTypes={confirmButtonText:u().node,linkText:u().node,modalMessage:u().node,modalTitle:u().node,onDelete:u().func.isRequired,openModal:u().any.isRequired};const Ue={openModal:Ie.h},qe=(0,s.connect)(null,Ue)(je);function De(e){return m.createElement(qe,{confirmButtonText:m.createElement(T.Z,{id:"emoji_list.delete.confirm.button",defaultMessage:"Delete"}),linkText:m.createElement(T.Z,{id:"emoji_list.delete",defaultMessage:"Delete"}),modalMessage:m.createElement(T.Z,{id:"emoji_list.delete.confirm.msg",defaultMessage:"This action permanently deletes the custom emoji. Are you sure you want to delete it?"}),modalTitle:m.createElement(T.Z,{id:"emoji_list.delete.confirm.title",defaultMessage:"Delete Custom Emoji"}),onDelete:e.onDelete})}function Le(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}De.propTypes={onDelete:u().func.isRequired};class We extends m.PureComponent{constructor(){super(...arguments),Le(this,"handleDelete",(()=>{this.props.onDelete&&this.props.onDelete(this.props.emoji.id),this.props.actions.deleteCustomEmoji(this.props.emoji.id)}))}render(){const e=this.props.emoji,t=this.props.creatorUsername;let a=this.props.creatorDisplayName;t&&t!==a&&(a+=" (@"+t+")");let s=m.createElement(De,{onDelete:this.handleDelete});return s=e.creator_id===this.props.currentUserId?m.createElement(Te.Z,{permissions:[Se.Z.DELETE_EMOJIS]},s):m.createElement(Te.Z,{permissions:[Se.Z.DELETE_EMOJIS]},m.createElement(Te.Z,{permissions:[Se.Z.DELETE_OTHERS_EMOJIS]},s)),m.createElement("tr",{className:"backstage-list__item"},m.createElement("td",{className:"emoji-list__name"},":"+e.name+":"),m.createElement("td",{className:"emoji-list__image"},m.createElement("span",{className:"emoticon",style:{backgroundImage:"url("+Pe.je.getCustomEmojiImageUrl(e.id)+")"}})),m.createElement("td",{className:"emoji-list__creator"},a),m.createElement("td",{className:"emoji-list-item_actions"},s))}}Le(We,"propTypes",{emojiId:u().string,currentUserId:u().string,creatorDisplayName:u().string,creatorUsername:u().string,onDelete:u().func,actions:u().shape({deleteCustomEmoji:u().func.isRequired}).isRequired}),Le(We,"defaultProps",{emoji:{},currentUserId:"",creatorDisplayName:""});const He=(0,s.connect)((function(e,t){const a=e.entities.emojis.customEmoji[t.emojiId],s=(0,o.PR)(e,a.creator_id);return{emoji:a,creatorDisplayName:(0,R.hI)(e,s),creatorUsername:s?s.username:"",currentUserId:(0,o.rc)(e),currentTeam:(0,r.kA)(e)}}),(function(e){return{actions:(0,p.bindActionCreators)({deleteCustomEmoji:Re._2},e)}}))(We);var Be=a(86040),Fe=a(42243),Ge=a(927);function Ye(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class ze extends m.PureComponent{constructor(e){super(e),Ye(this,"searchTimeout",void 0),Ye(this,"nextPage",(e=>{e&&e.preventDefault();const t=this.state.page+1;this.setState({nextLoading:!0}),this.props.actions.getCustomEmojis(t,50,c.dy.SORT_BY_NAME,!0).then((e=>{let{data:a}=e;this.setState({page:t,nextLoading:!1}),a&&a.length<50&&this.setState({missingPages:!1}),this.props.scrollToTop()}))})),Ye(this,"previousPage",(e=>{e&&e.preventDefault(),this.setState({page:this.state.page-1,nextLoading:!1,missingPages:!0}),this.props.scrollToTop()})),Ye(this,"onSearchChange",(e=>{if(!e||!e.target)return;const t=e.target.value||"";clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((async()=>{if(""===t.trim())return void this.setState({searchEmojis:null,page:0});this.setState({loading:!0});const{data:e}=await this.props.actions.searchCustomEmojis(t,{},!0);e?this.setState({searchEmojis:e.map((e=>e.id)),loading:!1}):this.setState({searchEmojis:[],loading:!1})}),200)})),Ye(this,"deleteFromSearch",(e=>{if(!this.state.searchEmojis)return;const t=this.state.searchEmojis.indexOf(e);if(t<0)return;const a=[...this.state.searchEmojis];a.splice(t,1),this.setState({searchEmojis:a})})),this.searchTimeout=null,this.state={loading:!0,page:0,nextLoading:!1,searchEmojis:null,missingPages:!0}}async componentDidMount(){this.props.actions.getCustomEmojis(0,51,c.dy.SORT_BY_NAME,!0).then((e=>{let{data:t}=e;this.setState({loading:!1}),t&&t.length<50&&this.setState({missingPages:!1})}))}render(){const e=this.state.searchEmojis,t=[];let a,s;if(this.state.loading)t.push(m.createElement("tr",{key:"loading",className:"backstage-list__item backstage-list__empty"},m.createElement("td",{colSpan:4},m.createElement(I.Z,{key:"loading"}))));else if(0===this.props.emojiIds.length||e&&0===e.length)t.push(m.createElement("tr",{key:"empty",className:"backstage-list__item backstage-list__empty"},m.createElement("td",{colSpan:4},m.createElement(T.Z,{id:"emoji_list.empty",defaultMessage:"No custom emoji found"}))));else if(e)e.forEach((e=>{t.push(m.createElement(He,{key:"emoji_search_item"+e,emojiId:e,onDelete:this.deleteFromSearch,actions:{deleteCustomEmoji:Re._2}}))}));else{const e=50*this.state.page,n=e+50;if(this.props.emojiIds.slice(e,n).forEach((e=>{t.push(m.createElement(He,{key:"emoji_list_item"+e,emojiId:e,actions:{deleteCustomEmoji:Re._2}}))})),this.state.missingPages){const e=m.createElement("span",null,m.createElement(T.Z,{id:"filtered_user_list.next",defaultMessage:"Next"}),m.createElement(Be.Z,{additionalClassName:"ml-2"}));a=m.createElement(B.Z,{btnClass:"btn-link",extraClasses:"pull-right",onClick:this.nextPage,saving:this.state.nextLoading,disabled:this.state.nextLoading,defaultMessage:e,savingMessage:e})}this.state.page>0&&(s=m.createElement("button",{className:"btn btn-link",onClick:this.previousPage},m.createElement(Fe.Z,{additionalClassName:"mr-2"}),m.createElement(T.Z,{id:"filtered_user_list.prev",defaultMessage:"Previous"})))}return m.createElement("div",null,m.createElement("div",{className:"backstage-filters"},m.createElement("div",{className:"backstage-filter__search"},m.createElement(x.Z,null),m.createElement(Ge.Z,{type:"search",className:"form-control",placeholder:{id:(0,oe.t)("emoji_list.search"),defaultMessage:"Search Custom Emoji"},onChange:this.onSearchChange,style:Je.search}))),m.createElement("span",{className:"backstage-list__help"},m.createElement("p",null,m.createElement(T.Z,{id:"emoji_list.help",defaultMessage:"Custom emoji are available to everyone on your server. Type ':' followed by two characters in a message box to bring up the emoji selection menu."})),m.createElement("p",null,m.createElement(T.Z,{id:"emoji_list.help2",defaultMessage:"Tip: If you add #, ##, or ### as the first character on a new line containing emoji, you can use larger sized emoji. To try it out, send a message such as: '# :smile:'."}))),m.createElement("div",{className:"backstage-list"},m.createElement("table",{className:"emoji-list__table"},m.createElement("thead",null,m.createElement("tr",{className:"backstage-list__item emoji-list__table-header"},m.createElement("th",{className:"emoji-list__name"},m.createElement(T.Z,{id:"emoji_list.name",defaultMessage:"Name"})),m.createElement("th",{className:"emoji-list__image"},m.createElement(T.Z,{id:"emoji_list.image",defaultMessage:"Image"})),m.createElement("th",{className:"emoji-list__creator"},m.createElement(T.Z,{id:"emoji_list.creator",defaultMessage:"Creator"})),m.createElement("th",{className:"emoji-list_actions"},m.createElement(T.Z,{id:"emoji_list.actions",defaultMessage:"Actions"})))),m.createElement("tbody",null,t))),m.createElement("div",{className:"filter-controls pt-3"},s,a))}}Ye(ze,"propTypes",{emojiIds:u().arrayOf(u().string).isRequired,scrollToTop:u().func.isRequired,actions:u().shape({getCustomEmojis:u().func.isRequired,searchCustomEmojis:u().func.isRequired}).isRequired});const Je={search:{flexGrow:0,flexShrink:0}},Ve=(0,s.connect)((function(e){return{emojiIds:(0,Ze.pI)(e)||[]}}),(function(e){return{actions:(0,p.bindActionCreators)({getCustomEmojis:Re.cc,searchCustomEmojis:Re.pL},e)}}))(ze);function Ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Xe extends m.PureComponent{constructor(){super(...arguments),Ke(this,"updateTitle",(()=>{document.title=R._u("custom_emoji.header","Custom Emoji")+" - "+this.props.teamDisplayName+" "+this.props.siteName}))}componentDidMount(){this.updateTitle(),this.props.actions.loadRolesIfNeeded(["system_admin","team_admin","system_user","team_user"])}componentDidUpdate(e){this.props.siteName!==e.siteName&&this.updateTitle()}render(){return m.createElement("div",{className:"backstage-content emoji-list"},m.createElement("div",{className:"backstage-header"},m.createElement("h1",null,m.createElement(T.Z,{id:"emoji_list.header",defaultMessage:"Custom Emoji"})),m.createElement(Te.Z,{permissions:[Se.Z.CREATE_EMOJIS]},m.createElement(P.Link,{className:"add-link",to:"/"+this.props.teamName+"/emoji/add"},m.createElement("button",{type:"button",className:"btn btn-primary"},m.createElement(T.Z,{id:"emoji_list.add",defaultMessage:"Add Custom Emoji"}))))),m.createElement(Ve,{scrollToTop:this.props.scrollToTop}))}}Ke(Xe,"propTypes",{teamId:u().string.isRequired,teamName:u().string,teamDisplayName:u().string,siteName:u().string,actions:u().shape({}).isRequired}),Ke(Xe,"defaultProps",{teamName:"",teamDisplayName:"",siteName:""});const Qe=(0,s.connect)((function(e){const t=(0,r.kA)(e)||{};return{teamId:t.id,teamName:t.name,teamDisplayName:t.display_name,siteName:e.entities.general.config.SiteName}}),(function(e){return{actions:(0,p.bindActionCreators)({loadRolesIfNeeded:Oe.k3},e)}}))(Xe);var $e=a(37792);function et(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a(23157),a(27852);class tt extends m.PureComponent{constructor(e){super(e),et(this,"handleFormSubmit",(async e=>this.handleSubmit(e))),et(this,"handleSaveButtonClick",(async e=>this.handleSubmit(e))),et(this,"handleSubmit",(async e=>{const{actions:t,emojiMap:a,user:s,team:n}=this.props,{image:o,name:r,saving:i}=this.state;if(e.preventDefault(),i)return;this.setState({saving:!0,error:null});const l={creator_id:s.id,name:r.trim().toLowerCase()};if(l.name.startsWith(":")&&l.name.endsWith(":")&&(l.name=l.name.substring(1,l.name.length-1)),!l.name)return void this.setState({saving:!1,error:m.createElement(T.Z,{id:"add_emoji.nameRequired",defaultMessage:"A name is required for the emoji"})});if(/[^a-z0-9+_-]/.test(l.name))return void this.setState({saving:!1,error:m.createElement(T.Z,{id:"add_emoji.nameInvalid",defaultMessage:"An emoji's name can only contain lowercase letters, numbers, and the symbols '-', '+' and '_'."})});if(a.hasSystemEmoji(l.name))return void this.setState({saving:!1,error:m.createElement(T.Z,{id:"add_emoji.nameTaken",defaultMessage:"This name is already in use by a system emoji. Please choose another name."})});if(a.has(l.name))return void this.setState({saving:!1,error:m.createElement(T.Z,{id:"add_emoji.customNameTaken",defaultMessage:"This name is already in use by a custom emoji. Please choose another name."})});if(!o)return void this.setState({saving:!1,error:m.createElement(T.Z,{id:"add_emoji.imageRequired",defaultMessage:"An image is required for the emoji"})});if(o.size>1048576)return void this.setState({saving:!1,error:m.createElement(T.Z,{id:"add_emoji.imageTooLarge",defaultMessage:"Unable to create emoji. Image must be less than 1 MB in size."})});const c=await t.createCustomEmoji(l,o);if("data"in c){const e=c;if(e&&e.data.name===l.name)return void se.m.push("/"+n.name+"/emoji")}if("error"in c){const e=c;if(e)return void this.setState({saving:!1,error:e.error.message})}const d=m.createElement(T.Z,{id:"add_emoji.failedToAdd",defaultMessage:"Something when wrong when adding the custom emoji."});this.setState({saving:!1,error:d})})),et(this,"updateName",(e=>{this.setState({name:e.target.value})})),et(this,"updateImage",(e=>{if(null==e.target.files||0===e.target.files.length)return void this.setState({image:null,imageUrl:""});const t=e.target.files[0],a=new FileReader;a.onload=()=>{this.setState({image:t,imageUrl:a.result})},a.readAsDataURL(t)})),this.state={name:"",image:null,imageUrl:"",saving:!1,error:null}}render(){let e=null;this.state.image&&(e=m.createElement("span",{className:"add-emoji__filename"},this.state.image.name));let t=null;return this.state.imageUrl&&(t=m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"preview"},m.createElement(T.Z,{id:"add_emoji.preview",defaultMessage:"Preview"})),m.createElement("div",{className:"col-md-5 col-sm-8 add-emoji__preview"},m.createElement(T.Z,{id:"add_emoji.preview.sentence",defaultMessage:"This is a sentence with {image} in it.",values:{image:m.createElement("span",{className:"emoticon",style:{backgroundImage:"url("+this.state.imageUrl+")"}})}})))),m.createElement("div",{className:"backstage-content row"},m.createElement(re,null,m.createElement(P.Link,{to:"/"+this.props.team.name+"/emoji"},m.createElement(T.Z,{id:"emoji_list.header",defaultMessage:"Custom Emoji"})),m.createElement(T.Z,{id:"add_emoji.header",defaultMessage:"Add"})),m.createElement("div",{className:"backstage-form"},m.createElement("form",{className:"form-horizontal",onSubmit:this.handleFormSubmit},m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"name"},m.createElement(T.Z,{id:"add_emoji.name",defaultMessage:"Name"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"name",type:"text",maxLength:64,className:"form-control",value:this.state.name,onChange:this.updateName}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_emoji.name.help",defaultMessage:"Name your emoji. The name can be up to 64 characters, and can contain lowercase letters, numbers, and the symbols '-' and '_'."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"image"},m.createElement(T.Z,{id:"add_emoji.image",defaultMessage:"Image"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("div",null,m.createElement("div",{className:"add-emoji__upload"},m.createElement("button",{className:"btn btn-primary"},m.createElement(T.Z,{id:"add_emoji.image.button",defaultMessage:"Select"})),m.createElement("input",{id:"select-emoji",type:"file",accept:D.gT.ACCEPT_EMOJI_IMAGE,multiple:!1,onChange:this.updateImage})),e,m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_emoji.image.help",defaultMessage:"Specify a .gif, .png, or .jpg file of up to 64 KB for your emoji. The dimensions can be up to 128 pixels by 128 pixels."}))))),t,m.createElement("div",{className:"backstage-form__footer"},m.createElement(me.Z,{type:"backstage",error:this.state.error}),m.createElement(P.Link,{className:"btn btn-link btn-sm",to:"/"+this.props.team.name+"/emoji"},m.createElement(T.Z,{id:"add_emoji.cancel",defaultMessage:"Cancel"})),m.createElement(ce.Z,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:(0,R._u)("add_emoji.saving","Saving..."),onClick:this.handleSaveButtonClick},m.createElement(T.Z,{id:"add_emoji.save",defaultMessage:"Save"}))))))}}et(tt,"propTypes",{actions:u().shape({createCustomEmoji:u().func.isRequired}).isRequired});const at=(0,s.connect)((function(e){return{emojiMap:(0,$e.kM)(e)}}),(function(e){return{actions:(0,p.bindActionCreators)({createCustomEmoji:Re.uK},e)}}))(tt);var st=a(9276);const nt=100;function ot(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nt;return async s=>{const{data:n}=await s(b.tJ(e,t,a));n&&s(rt(n))}}function rt(e){return async(t,a)=>{const s=a(),n={};for(let t=0;t<e.length;t++){const a=e[t];(0,o.PR)(s,a.user_id)||(n[a.user_id]=!0)}const r=Object.keys(n);0!==r.length&&t((0,S.Ef)(r))}}function it(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nt;return async s=>{const{data:n}=await s(b.w9("",e,t,a));n&&s(lt(n))}}function lt(e){return async(t,a)=>{const s=a(),n={};for(let t=0;t<e.length;t++){const a=e[t];(0,o.PR)(s,a.creator_id)||(n[a.creator_id]=!0)}const r=Object.keys(n);0!==r.length&&t((0,S.Ef)(r))}}function ct(e){return async t=>{const{data:a}=await t(b.cC(e));var s;a&&t((s=a,async(e,t)=>{const a=t(),n={};for(let e=0;e<s.length;e++){const t=s[e];(0,o.PR)(a,t.creator_id)||(n[t.creator_id]=!0)}const r=Object.keys(n);0!==r.length&&e((0,S.Ef)(r))}))}}function mt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt;return async(a,s)=>{(0,E.D8)(s())&&a(b.D());const{data:n}=await a(b.i5(e,t));n&&a(dt(n))}}function dt(e){return async(t,a)=>{const s=a(),n={};for(let t=0;t<e.length;t++){const a=e[t];(0,o.PR)(s,a.creator_id)||(n[a.creator_id]=!0)}const r=Object.keys(n);0!==r.length&&t((0,S.Ef)(r))}}function ut(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class pt extends m.PureComponent{constructor(){super(...arguments),ut(this,"copyText",(e=>{e.preventDefault(),(0,R.vQ)(this.props.value)}))}render(){if(!document.queryCommandSupported("copy"))return null;const e=m.createElement(le.Z,{id:"copy"},m.createElement(T.Z,{id:this.props.idMessage,defaultMessage:this.props.defaultMessage}));return m.createElement(ie.Z,{delayShow:D.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:e},m.createElement("a",{href:"#","data-testid":"copyText",className:"fa fa-copy ml-2",onClick:this.copyText}))}}function ht(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function gt(e,t,a){return!a||-1!==e.display_name.toLowerCase().indexOf(a)||-1!==e.description.toLowerCase().indexOf(a)||!(!e.channel_id||!t||-1===t.name.toLowerCase().indexOf(a))}ut(pt,"propTypes",{value:u().string.isRequired,defaultMessage:u().string,idMessage:u().string}),ut(pt,"defaultProps",{defaultMessage:"Copy",idMessage:"integrations.copy"});class bt extends m.PureComponent{constructor(){super(...arguments),ht(this,"handleDelete",(()=>{this.props.onDelete(this.props.incomingWebhook)}))}render(){const e=this.props.incomingWebhook,t=this.props.channel;if(!gt(e,t,this.props.filter?this.props.filter.toLowerCase():""))return null;let a;a=e.display_name?e.display_name:t?t.display_name:m.createElement(T.Z,{id:"installed_incoming_webhooks.unknown_channel",defaultMessage:"A Private Webhook"});let s=null;e.description&&(s=m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__description"},e.description)));let n=null;this.props.canChange&&(n=m.createElement("div",{className:"item-actions"},m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/incoming_webhooks/edit?id=").concat(e.id)},m.createElement(T.Z,{id:"installed_integrations.edit",defaultMessage:"Edit"}))," - ",m.createElement(qe,{modalMessage:m.createElement(T.Z,{id:"installed_incoming_webhooks.delete.confirm",defaultMessage:"This action permanently deletes the incoming webhook and breaks any integrations using it. Are you sure you want to delete it?"}),onDelete:this.handleDelete})));const o=(0,Z.fO)()+"/hooks/"+e.id;return m.createElement("div",{className:"backstage-list__item"},m.createElement("div",{className:"item-details"},m.createElement("div",{className:"item-details__row d-flex flex-column flex-md-row justify-content-between"},m.createElement("strong",{className:"item-details__name"},a),n),s,m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__url word-break--all"},m.createElement(T.Z,{id:"installed_integrations.url",defaultMessage:"URL: {url}",values:{url:o}}),m.createElement("span",null,m.createElement(pt,{value:o})))),m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__creation"},m.createElement(T.Z,{id:"installed_integrations.creation",defaultMessage:"Created by {creator} on {createAt, date, full}",values:{creator:this.props.creator.username,createAt:e.create_at}})))))}}function ft(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}ht(bt,"propTypes",{incomingWebhook:u().object.isRequired,onDelete:u().func.isRequired,filter:u().string,creator:u().object.isRequired,canChange:u().bool.isRequired,team:u().object.isRequired,channel:u().object});class Et extends m.PureComponent{constructor(e){super(e),ft(this,"deleteIncomingWebhook",(e=>{this.props.actions.removeIncomingHook(e.id)})),ft(this,"incomingWebhookCompare",((e,t)=>{let a=e.display_name;if(!a){const t=this.props.channels[e.channel_id];a=t?t.display_name:R._u("installed_incoming_webhooks.unknown_channel","A Private Webhook")}const s=t.display_name;return a.localeCompare(s)})),ft(this,"incomingWebhooks",(e=>this.props.incomingWebhooks.sort(this.incomingWebhookCompare).filter((t=>gt(t,this.props.channels[t.channel_id],e))).map((e=>{const t=this.props.canManageOthersWebhooks||this.props.user.id===e.user_id,a=this.props.channels[e.channel_id];return m.createElement(bt,{key:e.id,incomingWebhook:e,onDelete:this.deleteIncomingWebhook,creator:this.props.users[e.user_id]||{},canChange:t,team:this.props.team,channel:a})})))),this.state={loading:!0}}componentDidMount(){this.props.enableIncomingWebhooks&&this.props.actions.loadIncomingHooksAndProfilesForTeam(this.props.team.id,D.ZP.Integrations.START_PAGE_NUM,D.ZP.Integrations.PAGE_SIZE).then((()=>this.setState({loading:!1})))}render(){return m.createElement(U,{header:m.createElement(T.Z,{id:"installed_incoming_webhooks.header",defaultMessage:"Installed Incoming Webhooks"}),addText:m.createElement(T.Z,{id:"installed_incoming_webhooks.add",defaultMessage:"Add Incoming Webhook"}),addLink:"/"+this.props.team.name+"/integrations/incoming_webhooks/add",addButtonId:"addIncomingWebhook",emptyText:m.createElement(T.Z,{id:"installed_incoming_webhooks.empty",defaultMessage:"No incoming webhooks found"}),emptyTextSearch:m.createElement(L.Z,{id:"installed_incoming_webhooks.emptySearch",defaultMessage:"No incoming webhooks match {searchTerm}"}),helpText:m.createElement(T.Z,{id:"installed_incoming_webhooks.help",defaultMessage:"Use incoming webhooks to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.",values:{buildYourOwn:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://developers.mattermost.com/integrate/admin-guide/admin-webhooks-incoming/"},m.createElement(T.Z,{id:"installed_incoming_webhooks.help.buildYourOwn",defaultMessage:"Build Your Own"})),appDirectory:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mattermost.com/marketplace"},m.createElement(T.Z,{id:"installed_incoming_webhooks.help.appDirectory",defaultMessage:"App Directory"}))}}),searchPlaceholder:R._u("installed_incoming_webhooks.search","Search Incoming Webhooks"),loading:this.state.loading},(e=>{const t=this.incomingWebhooks(e);return[t,t.length>0]}))}}ft(Et,"propTypes",{canManageOthersWebhooks:u().bool.isRequired,incomingWebhooks:u().array.isRequired,enableIncomingWebhooks:u().bool.isRequired,actions:u().shape({removeIncomingHook:u().func.isRequired,loadIncomingHooksAndProfilesForTeam:u().func.isRequired}).isRequired});const _t=(0,s.connect)((function(e){const t=(0,i.iE)(e),a=(0,r.ev)(e),s=(0,l.Rm)(e,a,c.Pl.MANAGE_OTHERS_INCOMING_WEBHOOKS),n=y(e),m=Object.keys(n).map((e=>n[e])).filter((e=>e.team_id===a)),d="true"===t.EnableIncomingWebhooks;return{incomingWebhooks:m,channels:(0,st.IU)(e),users:(0,o.Rf)(e),canManageOthersWebhooks:s,enableIncomingWebhooks:d}}),(function(e){return{actions:(0,p.bindActionCreators)({loadIncomingHooksAndProfilesForTeam:ot,removeIncomingHook:b.Ht},e)}}))(Et);var kt=a(29757),vt=a(80555);class yt extends m.PureComponent{render(){const e=[m.createElement("option",{key:"",value:""},R._u("channel_select.placeholder","--- Select a channel ---"))];return this.props.channels.forEach((t=>{const a=t.display_name||t.name;(t.type===D.ZP.OPEN_CHANNEL&&this.props.selectOpen||t.type===D.ZP.PRIVATE_CHANNEL&&this.props.selectPrivate||t.type===D.ZP.DM_CHANNEL&&this.props.selectDm)&&e.push(m.createElement("option",{key:t.id,value:t.id},a))})),m.createElement("select",{className:"form-control",value:this.props.value,onChange:this.props.onChange,id:"channelSelect"},e)}}!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(yt,"propTypes",{channels:u().array.isRequired,onChange:u().func,value:u().string,selectOpen:u().bool.isRequired,selectPrivate:u().bool.isRequired,selectDm:u().bool.isRequired});const Nt=(0,f.P1)("getMyChannelsSorted",st.qB,kt.M,((e,t)=>[...e].sort(vt.Ut.bind(null,t)))),Mt=(0,s.connect)((function(e){return{channels:Nt(e)}}))(yt);function wt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Ct extends m.PureComponent{constructor(e){super(e),wt(this,"getStateFromHook",(e=>({displayName:e.display_name||"",description:e.description||"",channelId:e.channel_id||"",channelLocked:e.channel_locked||!1,username:e.username||"",iconURL:e.icon_url||"",saving:!1,serverError:"",clientError:null}))),wt(this,"handleSubmit",(e=>{if(e.preventDefault(),this.state.saving)return;if(this.setState({saving:!0,serverError:"",clientError:""}),!this.state.channelId)return void this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_incoming_webhook.channelRequired",defaultMessage:"A valid channel is required"})});const t={channel_id:this.state.channelId,channel_locked:this.state.channelLocked,display_name:this.state.displayName,description:this.state.description,username:this.state.username,icon_url:this.state.iconURL};this.props.action(t).then((()=>this.setState({saving:!1})))})),wt(this,"updateDisplayName",(e=>{this.setState({displayName:e.target.value})})),wt(this,"updateDescription",(e=>{this.setState({description:e.target.value})})),wt(this,"updateChannelId",(e=>{this.setState({channelId:e.target.value})})),wt(this,"updateChannelLocked",(e=>{this.setState({channelLocked:e.target.checked})})),wt(this,"updateUsername",(e=>{this.setState({username:e.target.value})})),wt(this,"updateIconURL",(e=>{this.setState({iconURL:e.target.value})})),this.state=this.getStateFromHook(this.props.initialHook||{})}render(){var e=this.props.header,t=this.props.footer;return m.createElement("div",{className:"backstage-content"},m.createElement(re,null,m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/incoming_webhooks")},m.createElement(T.Z,{id:"installed_incoming_webhooks.header",defaultMessage:"Incoming Webhooks"})),m.createElement(T.Z,{id:e.id,defaultMessage:e.defaultMessage})),m.createElement("div",{className:"backstage-form"},m.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},m.createElement(T.Z,{id:"add_incoming_webhook.displayName",defaultMessage:"Title"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_incoming_webhook.displayName.help",defaultMessage:"Specify a title, of up to 64 characters, for the webhook settings page."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.createElement(T.Z,{id:"add_incoming_webhook.description",defaultMessage:"Description"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"description",type:"text",maxLength:"500",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_incoming_webhook.description.help",defaultMessage:"Describe your incoming webhook."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"channelId"},m.createElement(T.Z,{id:"add_incoming_webhook.channel",defaultMessage:"Channel"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement(Mt,{id:"channelId",value:this.state.channelId,onChange:this.updateChannelId,selectOpen:!0,selectPrivate:!0}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_incoming_webhook.channel.help",defaultMessage:"This is the default public or private channel that receives the webhook payloads.  When setting up the webhook, you must belong to the private channel."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"channelLocked"},m.createElement(T.Z,{id:"add_incoming_webhook.channelLocked",defaultMessage:"Lock to this channel"})),m.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},m.createElement("input",{id:"channelLocked",type:"checkbox",checked:this.state.channelLocked,onChange:this.updateChannelLocked}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_incoming_webhook.channelLocked.help",defaultMessage:"If set, the incoming webhook can post only to the selected channel."})))),this.props.enablePostUsernameOverride&&m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},m.createElement(T.Z,{id:"add_incoming_webhook.username",defaultMessage:"Username"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"username",type:"text",maxLength:"22",className:"form-control",value:this.state.username,onChange:this.updateUsername}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_incoming_webhook.username.help",defaultMessage:'Specify the username this integration will post as. Usernames can be up to 22 characters, and can contain lowercase letters, numbers and the symbols \\"-\\", \\"_\\", and \\".\\". If left blank, the name specified by the webhook creator is used.'})))),this.props.enablePostIconOverride&&m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"iconURL"},m.createElement(T.Z,{id:"add_incoming_webhook.icon_url",defaultMessage:"Profile Picture"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"iconURL",type:"text",maxLength:"1024",className:"form-control",value:this.state.iconURL,onChange:this.updateIconURL}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_incoming_webhook.icon_url.help",defaultMessage:"Enter the URL of a .png or .jpg file for the profile picture of this integration when posting. The file should be at least 128 pixels by 128 pixels. If left blank, the profile picture specified by the webhook creator is used."})))),m.createElement("div",{className:"backstage-form__footer"},m.createElement(me.Z,{type:"backstage",errors:[this.props.serverError,this.state.clientError]}),m.createElement(P.Link,{className:"btn btn-link btn-sm",to:"/".concat(this.props.team.name,"/integrations/incoming_webhooks")},m.createElement(T.Z,{id:"add_incoming_webhook.cancel",defaultMessage:"Cancel"})),m.createElement(ce.Z,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:(0,R._u)(this.props.loading.id,this.props.loading.defaultMessage),onClick:this.handleSubmit,id:"saveWebhook"},m.createElement(T.Z,{id:t.id,defaultMessage:t.defaultMessage}))))))}}function At(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}wt(Ct,"propTypes",{team:u().object.isRequired,header:u().object.isRequired,footer:u().object.isRequired,loading:u().object.isRequired,serverError:u().string.isRequired,initialHook:u().object,enablePostUsernameOverride:u().bool.isRequired,enablePostIconOverride:u().bool.isRequired,action:u().func.isRequired});const Ot={id:(0,oe.t)("integrations.add"),defaultMessage:"Add"},St={id:(0,oe.t)("add_incoming_webhook.save"),defaultMessage:"Save"},Tt={id:(0,oe.t)("add_incoming_webhook.saving"),defaultMessage:"Saving..."};class Zt extends m.PureComponent{constructor(e){super(e),At(this,"addIncomingHook",(async e=>{this.setState({serverError:""});const{data:t,error:a}=await this.props.actions.createIncomingHook(e);t?se.m.push("/".concat(this.props.team.name,"/integrations/confirm?type=incoming_webhooks&id=").concat(t.id)):a&&this.setState({serverError:a.message})})),this.state={serverError:""}}render(){return m.createElement(Ct,{team:this.props.team,header:Ot,footer:St,loading:Tt,enablePostUsernameOverride:this.props.enablePostUsernameOverride,enablePostIconOverride:this.props.enablePostIconOverride,action:this.addIncomingHook,serverError:this.state.serverError})}}At(Zt,"propTypes",{enablePostUsernameOverride:u().bool.isRequired,enablePostIconOverride:u().bool.isRequired,actions:u().shape({createIncomingHook:u().func.isRequired}).isRequired});const Rt=(0,s.connect)((function(e){const t=(0,i.iE)(e);return{enablePostUsernameOverride:"true"===t.EnablePostUsernameOverride,enablePostIconOverride:"true"===t.EnablePostIconOverride}}),(function(e){return{actions:(0,p.bindActionCreators)({createIncomingHook:b.ct},e)}}))(Zt);function Pt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const It={id:(0,oe.t)("integrations.edit"),defaultMessage:"Edit"},xt={id:(0,oe.t)("update_incoming_webhook.update"),defaultMessage:"Update"},jt={id:(0,oe.t)("update_incoming_webhook.updating"),defaultMessage:"Updating..."};class Ut extends m.PureComponent{constructor(e){super(e),Pt(this,"newHook",void 0),Pt(this,"editIncomingHook",(async e=>{var t;this.newHook=e,null!==(t=this.props.hook)&&void 0!==t&&t.id&&(e.id=this.props.hook.id),await this.submitHook()})),Pt(this,"submitHook",(async()=>{if(this.setState({serverError:""}),!this.newHook)return;const e=await this.props.actions.updateIncomingHook(this.newHook);if("data"in e)se.m.push("/".concat(this.props.team.name,"/integrations/incoming_webhooks"));else if("error"in e){const{error:t}=e;this.setState({serverError:t.message})}})),this.state={showConfirmModal:!1,serverError:""}}componentDidMount(){this.props.enableIncomingWebhooks&&this.props.actions.getIncomingHook(this.props.hookId)}render(){return this.props.hook?m.createElement(Ct,{team:this.props.team,header:It,footer:xt,loading:jt,enablePostUsernameOverride:this.props.enablePostUsernameOverride,enablePostIconOverride:this.props.enablePostIconOverride,action:this.editIncomingHook,serverError:this.state.serverError,initialHook:this.props.hook}):m.createElement(I.Z,null)}}Pt(Ut,"propTypes",{hookId:u().string.isRequired,enableIncomingWebhooks:u().bool.isRequired,enablePostUsernameOverride:u().bool.isRequired,enablePostIconOverride:u().bool.isRequired,actions:u().shape({updateIncomingHook:u().func.isRequired,getIncomingHook:u().func.isRequired}).isRequired});const qt=(0,s.connect)((function(e,t){const a=(0,i.iE)(e),s="true"===a.EnableIncomingWebhooks,n="true"===a.EnablePostUsernameOverride,o="true"===a.EnablePostIconOverride,r=new URLSearchParams(t.location.search).get("id")||"";return{hookId:r,hook:e.entities.integrations.incomingHooks[r],enableIncomingWebhooks:s,enablePostUsernameOverride:n,enablePostIconOverride:o}}),(function(e){return{actions:(0,p.bindActionCreators)({updateIncomingHook:b.V4,getIncomingHook:b.kA},e)}}))(Ut);function Dt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Lt(e,t,a){if(!a)return!0;const{display_name:s,description:n,trigger_words:o}=e;if(s&&-1!==s.toLowerCase().indexOf(a)||n&&-1!==n.toLowerCase().indexOf(a))return!0;if(o)for(const e of o)if(-1!==e.toLowerCase().indexOf(a))return!0;return!(!t||!t.name||-1===t.name.toLowerCase().indexOf(a))}class Wt extends m.PureComponent{constructor(){super(...arguments),Dt(this,"handleRegenToken",(e=>{e.preventDefault(),this.props.onRegenToken(this.props.outgoingWebhook)})),Dt(this,"handleDelete",(()=>{this.props.onDelete(this.props.outgoingWebhook)}))}makeDisplayName(e,t){return e.display_name?e.display_name:t?t.display_name:m.createElement(T.Z,{id:"installed_outgoing_webhooks.unknown_channel",defaultMessage:"A Private Webhook"})}render(){const e=this.props.outgoingWebhook,t=this.props.channel,a=this.props.filter?this.props.filter.toLowerCase():"";if(e&&!Lt(e,t,a))return null;const s=this.makeDisplayName(e,t);let n=null;e.description&&(n=m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__description"},e.description)));let o=null;e.trigger_words&&e.trigger_words.length>0&&(o=m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__trigger-words"},m.createElement(T.Z,{id:"installed_integrations.triggerWords",defaultMessage:"Trigger Words: {triggerWords}",values:{triggerWords:e.trigger_words.join(", ")}}))));const r=m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__url word-break--all"},m.createElement(T.Z,{id:"installed_integrations.callback_urls",defaultMessage:"Callback URLs: {urls}",values:{urls:e.callback_urls.join(", ")}})));let i;0===e.trigger_when?i=m.createElement(T.Z,{id:"add_outgoing_webhook.triggerWordsTriggerWhenFullWord",defaultMessage:"First word matches a trigger word exactly"}):1===e.trigger_when&&(i=m.createElement(T.Z,{id:"add_outgoing_webhook.triggerWordsTriggerWhenStartsWith",defaultMessage:"First word starts with a trigger word"}));let l=null;return this.props.canChange&&(l=m.createElement("div",{className:"item-actions"},m.createElement("button",{className:"style--none color--link",onClick:this.handleRegenToken},m.createElement(T.Z,{id:"installed_integrations.regenToken",defaultMessage:"Regen Token"}))," - ",m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/outgoing_webhooks/edit?id=").concat(e.id)},m.createElement(T.Z,{id:"installed_integrations.edit",defaultMessage:"Edit"}))," - ",m.createElement(qe,{modalMessage:m.createElement(T.Z,{id:"installed_outgoing_webhooks.delete.confirm",defaultMessage:"This action permanently deletes the outgoing webhook and breaks any integrations using it. Are you sure you want to delete it?"}),onDelete:this.handleDelete}))),m.createElement("div",{className:"backstage-list__item"},m.createElement("div",{className:"item-details"},m.createElement("div",{className:"item-details__row d-flex flex-column flex-md-row justify-content-between"},m.createElement("strong",{className:"item-details__name"},s),l),n,m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__content_type"},m.createElement(T.Z,{id:"installed_integrations.content_type",defaultMessage:"Content-Type: {contentType}",values:{contentType:e.content_type||"application/x-www-form-urlencoded"}}))),o,m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__trigger-when"},m.createElement(T.Z,{id:"installed_integrations.triggerWhen",defaultMessage:"Trigger When: {triggerWhen}",values:{triggerWhen:i}}))),m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__token"},m.createElement(T.Z,{id:"installed_integrations.token",defaultMessage:"Token: {token}",values:{token:e.token}}),m.createElement(pt,{value:e.token}))),m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__creation"},m.createElement(T.Z,{id:"installed_integrations.creation",defaultMessage:"Created by {creator} on {createAt, date, full}",values:{creator:this.props.creator.username,createAt:e.create_at}}))),r))}}function Ht(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Dt(Wt,"propTypes",{outgoingWebhook:u().object.isRequired,onRegenToken:u().func.isRequired,onDelete:u().func.isRequired,filter:u().string,creator:u().object.isRequired,canChange:u().bool.isRequired,team:u().object.isRequired,channel:u().object});class Bt extends m.PureComponent{constructor(e){super(e),Ht(this,"regenOutgoingWebhookToken",(e=>{this.props.actions.regenOutgoingHookToken(e.id)})),Ht(this,"removeOutgoingHook",(e=>{this.props.actions.removeOutgoingHook(e.id)})),Ht(this,"outgoingWebhookCompare",((e,t)=>{let a=e.display_name;if(!a){const t=this.props.channels[e.channel_id];a=t?t.display_name:R._u("installed_outgoing_webhooks.unknown_channel","A Private Webhook")}let s=t.display_name;if(!s){const e=this.props.channels[t.channel_id];s=e?e.display_name:R._u("installed_outgoing_webhooks.unknown_channel","A Private Webhook")}return a.localeCompare(s)})),Ht(this,"outgoingWebhooks",(e=>this.props.outgoingWebhooks.sort(this.outgoingWebhookCompare).filter((t=>Lt(t,this.props.channels[t.channel_id],e))).map((e=>{const t=this.props.canManageOthersWebhooks||this.props.user.id===e.creator_id,a=this.props.channels[e.channel_id];return m.createElement(Wt,{key:e.id,outgoingWebhook:e,onRegenToken:this.regenOutgoingWebhookToken,onDelete:this.removeOutgoingHook,creator:this.props.users[e.creator_id]||{},canChange:t,team:this.props.team,channel:a})})))),this.state={loading:!0}}componentDidMount(){this.props.enableOutgoingWebhooks&&this.props.actions.loadOutgoingHooksAndProfilesForTeam(this.props.teamId,D.ZP.Integrations.START_PAGE_NUM,D.ZP.Integrations.PAGE_SIZE).then((()=>this.setState({loading:!1})))}render(){return m.createElement(U,{header:m.createElement(T.Z,{id:"installed_outgoing_webhooks.header",defaultMessage:"Installed Outgoing Webhooks"}),addText:m.createElement(T.Z,{id:"installed_outgoing_webhooks.add",defaultMessage:"Add Outgoing Webhook"}),addLink:"/"+this.props.team.name+"/integrations/outgoing_webhooks/add",addButtonId:"addOutgoingWebhook",emptyText:m.createElement(T.Z,{id:"installed_outgoing_webhooks.empty",defaultMessage:"No outgoing webhooks found"}),emptyTextSearch:m.createElement(L.Z,{id:"installed_outgoing_webhooks.emptySearch",defaultMessage:"No outgoing webhooks match {searchTerm}"}),helpText:m.createElement(T.Z,{id:"installed_outgoing_webhooks.help",defaultMessage:"Use outgoing webhooks to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.",values:{buildYourOwn:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://developers.mattermost.com/integrate/admin-guide/admin-webhooks-outgoing/"},m.createElement(T.Z,{id:"installed_outgoing_webhooks.help.buildYourOwn",defaultMessage:"Build your own"})),appDirectory:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mattermost.com/marketplace"},m.createElement(T.Z,{id:"installed_outgoing_webhooks.help.appDirectory",defaultMessage:"App Directory"}))}}),searchPlaceholder:R._u("installed_outgoing_webhooks.search","Search Outgoing Webhooks"),loading:this.state.loading},(e=>{const t=this.outgoingWebhooks(e);return[t,t.length>0]}))}}Ht(Bt,"propTypes",{team:u().object,user:u().object,canManageOthersWebhooks:u().bool,outgoingWebhooks:u().array,channels:u().object,users:u().object,teamId:u().string,actions:u().shape({removeOutgoingHook:u().func,loadOutgoingHooksAndProfilesForTeam:u().func,regenOutgoingHookToken:u().func}),enableOutgoingWebhooks:u().bool});const Ft=(0,s.connect)((function(e){const t=(0,i.iE)(e),a=(0,r.ev)(e),s=(0,l.Rm)(e,a,c.Pl.MANAGE_OTHERS_OUTGOING_WEBHOOKS),n=N(e),m=Object.keys(n).map((e=>n[e])).filter((e=>e.team_id===a)),d="true"===t.EnableOutgoingWebhooks;return{outgoingWebhooks:m,channels:(0,st.IU)(e),users:(0,o.Rf)(e),teamId:a,canManageOthersWebhooks:s,enableOutgoingWebhooks:d}}),(function(e){return{actions:(0,p.bindActionCreators)({loadOutgoingHooksAndProfilesForTeam:it,removeOutgoingHook:b.vn,regenOutgoingHookToken:b.Bm},e)}}))(Bt);function Gt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a(23123);class Yt extends m.PureComponent{constructor(e){super(e),Gt(this,"getStateFromHook",(e=>{let t="";if(e.trigger_words){let a=0;for(a=0;a<e.trigger_words.length;a++)t+=e.trigger_words[a]+"\n"}let a="";if(e.callback_urls){let t=0;for(t=0;t<e.callback_urls.length;t++)a+=e.callback_urls[t]+"\n"}return{displayName:e.display_name||"",description:e.description||"",contentType:e.content_type||"application/x-www-form-urlencoded",channelId:e.channel_id||"",triggerWords:t,triggerWhen:e.trigger_when||0,callbackUrls:a,saving:!1,clientError:null,username:e.username||"",iconURL:e.icon_url||""}})),Gt(this,"handleSubmit",(e=>{if(e.preventDefault(),this.state.saving)return;this.setState({saving:!0,clientError:""});const t=[];if(this.state.triggerWords)for(let e of this.state.triggerWords.split("\n"))e=e.trim(),e.length>0&&t.push(e);if(!this.state.channelId&&0===t.length)return void this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_outgoing_webhook.triggerWordsOrChannelRequired",defaultMessage:"A valid channel or a list of trigger words is required"})});const a=[];for(let e of this.state.callbackUrls.split("\n"))e=e.trim(),e.length>0&&a.push(e);if(0===a.length)return void this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_outgoing_webhook.callbackUrlsRequired",defaultMessage:"One or more callback URLs are required"})});const s={team_id:this.props.team.id,channel_id:this.state.channelId,trigger_words:t,trigger_when:parseInt(this.state.triggerWhen,10),callback_urls:a,display_name:this.state.displayName,content_type:this.state.contentType,description:this.state.description,username:this.state.username,icon_url:this.state.iconURL};this.props.action(s).then((()=>this.setState({saving:!1})))})),Gt(this,"updateDisplayName",(e=>{this.setState({displayName:e.target.value})})),Gt(this,"updateDescription",(e=>{this.setState({description:e.target.value})})),Gt(this,"updateContentType",(e=>{this.setState({contentType:e.target.value})})),Gt(this,"updateChannelId",(e=>{this.setState({channelId:e.target.value})})),Gt(this,"updateTriggerWords",(e=>{this.setState({triggerWords:e.target.value})})),Gt(this,"updateTriggerWhen",(e=>{this.setState({triggerWhen:e.target.value})})),Gt(this,"updateCallbackUrls",(e=>{this.setState({callbackUrls:e.target.value})})),Gt(this,"updateUsername",(e=>{this.setState({username:e.target.value})})),Gt(this,"updateIconURL",(e=>{this.setState({iconURL:e.target.value})})),this.state=this.getStateFromHook(this.props.initialHook||{})}render(){const e="application/x-www-form-urlencoded",t="application/json";var a=this.props.header,s=this.props.footer,n=this.props.renderExtra;return m.createElement("div",{className:"backstage-content"},m.createElement(re,null,m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/outgoing_webhooks")},m.createElement(T.Z,{id:"installed_outgoing_webhooks.header",defaultMessage:"Outgoing Webhooks"})),m.createElement(T.Z,{id:a.id,defaultMessage:a.defaultMessage})),m.createElement("div",{className:"backstage-form"},m.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},m.createElement(T.Z,{id:"add_outgoing_webhook.displayName",defaultMessage:"Title"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.displayName.help",defaultMessage:"Specify a title, of up to 64 characters, for the webhook settings page."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.createElement(T.Z,{id:"add_outgoing_webhook.description",defaultMessage:"Description"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"description",type:"text",maxLength:"500",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.description.help",defaultMessage:"Describe your outgoing webhook."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"contentType"},m.createElement(T.Z,{id:"add_outgoing_webhook.content_Type",defaultMessage:"Content Type"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("select",{className:"form-control",value:this.state.contentType,onChange:this.updateContentType},m.createElement("option",{value:e},e),m.createElement("option",{value:t},t)),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.contentType.help1",defaultMessage:"Specify the content type by which to send the request."})),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.contentType.help2",defaultMessage:"For the server to encode the parameters in a URL format in the request body, select application/x-www-form-urlencoded."})),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.contentType.help3",defaultMessage:"For the server to format the request body as JSON, select application/json."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"channelId"},m.createElement(T.Z,{id:"add_outgoing_webhook.channel",defaultMessage:"Channel"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement(Mt,{id:"channelId",value:this.state.channelId,onChange:this.updateChannelId,selectOpen:!0}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.channel.help",defaultMessage:"This field is optional if you specify at least one trigger word. Specify the public channel that delivers the payload to the webhook."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"triggerWords"},m.createElement(T.Z,{id:"add_outgoing_webhook.triggerWords",defaultMessage:"Trigger Words (One Per Line)"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("textarea",{id:"triggerWords",rows:"3",maxLength:"1000",className:"form-control",value:this.state.triggerWords,onChange:this.updateTriggerWords}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.triggerWords.help",defaultMessage:"Specify the trigger words that send an HTTP POST request to your application.  The trigger can be for the channel, the outgoing webhook, or both. If you select only Channel, trigger words are optional. If you select both, the message must match both values."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"triggerWords"},m.createElement(T.Z,{id:"add_outgoing_webhook.triggerWordsTriggerWhen",defaultMessage:"Trigger When"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("select",{className:"form-control",value:this.state.triggerWhen,onChange:this.updateTriggerWhen},m.createElement("option",{value:"0"},(0,R._u)("add_outgoing_webhook.triggerWordsTriggerWhenFullWord","First word matches a trigger word exactly")),m.createElement("option",{value:"1"},(0,R._u)("add_outgoing_webhook.triggerWordsTriggerWhenStartsWith","First word starts with a trigger word"))),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.triggerWordsTriggerWhen.help",defaultMessage:"Specify when to trigger the outgoing webhook."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"callbackUrls"},m.createElement(T.Z,{id:"add_outgoing_webhook.callbackUrls",defaultMessage:"Callback URLs (One Per Line)"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("textarea",{id:"callbackUrls",rows:"3",maxLength:"1000",className:"form-control",value:this.state.callbackUrls,onChange:this.updateCallbackUrls}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.callbackUrls.help",defaultMessage:"Specify the URL that the messages will be sent to. If the URL is private, add it as a {link}.",values:{link:m.createElement("a",{href:"https://docs.mattermost.com/configure/configuration-settings.html#session-lengths",target:"_blank",rel:"noopener noreferrer"},m.createElement(T.Z,{id:"add_outgoing_webhook.callbackUrls.helpLinkText",defaultMessage:"trusted internal connection"}))}})))),this.props.enablePostUsernameOverride&&m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},m.createElement(T.Z,{id:"add_outgoing_webhook.username",defaultMessage:"Username"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"username",type:"text",maxLength:"22",className:"form-control",value:this.state.username,onChange:this.updateUsername}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.username.help",defaultMessage:'Specify the username this integration will post as. Usernames can be up to 22 characters, and contain lowercase letters, numbers and the symbols \\"-\\", \\"_\\", and \\".\\". If left blank, the name specified by the webhook creator is used.'})))),this.props.enablePostIconOverride&&m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"iconURL"},m.createElement(T.Z,{id:"add_outgoing_webhook.icon_url",defaultMessage:"Profile Picture"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"iconURL",type:"text",maxLength:"1024",className:"form-control",value:this.state.iconURL,onChange:this.updateIconURL}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_outgoing_webhook.icon_url.help",defaultMessage:"Enter the URL of a .png or .jpg file for this integration to use as the profile picture when posting. The file should be at least 128 pixels by 128 pixels. If left blank, the profile picture specified by the webhook creator is used."})))),m.createElement("div",{className:"backstage-form__footer"},m.createElement(me.Z,{type:"backstage",errors:[this.props.serverError,this.state.clientError]}),m.createElement(P.Link,{className:"btn btn-link btn-sm",to:"/".concat(this.props.team.name,"/integrations/outgoing_webhooks")},m.createElement(T.Z,{id:"add_outgoing_webhook.cancel",defaultMessage:"Cancel"})),m.createElement(ce.Z,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:(0,R._u)(this.props.loading.id,this.props.loading.defaultMessage),onClick:this.handleSubmit,id:"saveWebhook"},m.createElement(T.Z,{id:s.id,defaultMessage:s.defaultMessage})),n))))}}function zt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Gt(Yt,"propTypes",{team:u().object.isRequired,header:u().object.isRequired,footer:u().object.isRequired,loading:u().object.isRequired,renderExtra:u().node.isRequired,serverError:u().string.isRequired,initialHook:u().object,action:u().func.isRequired,enablePostUsernameOverride:u().bool.isRequired,enablePostIconOverride:u().bool.isRequired});const Jt={id:(0,oe.t)("integrations.add"),defaultMessage:"Add"},Vt={id:(0,oe.t)("add_outgoing_webhook.save"),defaultMessage:"Save"},Kt={id:(0,oe.t)("add_outgoing_webhook.saving"),defaultMessage:"Saving..."};class Xt extends m.PureComponent{constructor(e){super(e),zt(this,"addOutgoingHook",(async e=>{this.setState({serverError:""});const{data:t,error:a}=await this.props.actions.createOutgoingHook(e);t?se.m.push("/".concat(this.props.team.name,"/integrations/confirm?type=outgoing_webhooks&id=").concat(t.id)):a&&this.setState({serverError:a.message})})),this.state={serverError:""}}render(){return m.createElement(Yt,{team:this.props.team,header:Jt,footer:Vt,loading:Kt,renderExtra:"",action:this.addOutgoingHook,serverError:this.state.serverError,enablePostUsernameOverride:this.props.enablePostUsernameOverride,enablePostIconOverride:this.props.enablePostIconOverride})}}zt(Xt,"propTypes",{team:u().object.isRequired,actions:u().shape({createOutgoingHook:u().func.isRequired}).isRequired,enablePostUsernameOverride:u().bool.isRequired,enablePostIconOverride:u().bool.isRequired});const Qt=(0,s.connect)((function(e){const t=(0,i.iE)(e);return{enablePostUsernameOverride:"true"===t.EnablePostUsernameOverride,enablePostIconOverride:"true"===t.EnablePostIconOverride}}),(function(e){return{actions:(0,p.bindActionCreators)({createOutgoingHook:b.M1},e)}}))(Xt);function $t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const ea={id:"integrations.edit",defaultMessage:"Edit"},ta={id:"update_outgoing_webhook.update",defaultMessage:"Update"},aa={id:"update_outgoing_webhook.updating",defaultMessage:"Updating..."};class sa extends m.PureComponent{constructor(e){super(e),$t(this,"newHook",void 0),$t(this,"editOutgoingHook",(async e=>{this.newHook=e,this.props.hook.id&&(e.id=this.props.hook.id),this.props.hook.token&&(e.token=this.props.hook.token);const t=this.props.hook.trigger_words.length===e.trigger_words.length&&this.props.hook.trigger_words.every(((t,a)=>t===e.trigger_words[a])),a=this.props.hook.callback_urls.length===e.callback_urls.length&&this.props.hook.callback_urls.every(((t,a)=>t===e.callback_urls[a]));this.props.hook.content_type===e.content_type&&t&&a?await this.submitHook():this.handleConfirmModal()})),$t(this,"handleConfirmModal",(()=>{this.setState({showConfirmModal:!0})})),$t(this,"confirmModalDismissed",(()=>{this.setState({showConfirmModal:!1})})),$t(this,"submitHook",(async()=>{this.setState({serverError:""});const{data:e,error:t}=await this.props.actions.updateOutgoingHook(this.newHook);e?se.m.push("/".concat(this.props.team.name,"/integrations/outgoing_webhooks")):(this.setState({showConfirmModal:!1}),t&&this.setState({serverError:t.message}))})),$t(this,"renderExtra",(()=>{const e=m.createElement(T.Z,{id:"update_outgoing_webhook.update",defaultMessage:"Update"}),t=m.createElement(T.Z,{id:"update_outgoing_webhook.confirm",defaultMessage:"Edit Outgoing Webhook"}),a=m.createElement(T.Z,{id:"update_outgoing_webhook.question",defaultMessage:"Your changes may break the existing outgoing webhook. Are you sure you would like to update it?"});return m.createElement(W.Z,{title:t,message:a,confirmButtonText:e,show:this.state.showConfirmModal,onConfirm:this.submitHook,onCancel:this.confirmModalDismissed})})),this.state={showConfirmModal:!1,serverError:""}}componentDidMount(){this.props.enableOutgoingWebhooks&&this.props.actions.getOutgoingHook(this.props.hookId)}render(){return this.props.hook?m.createElement(Yt,{team:this.props.team,header:ea,footer:ta,loading:aa,renderExtra:this.renderExtra(),action:this.editOutgoingHook,serverError:this.state.serverError,initialHook:this.props.hook,enablePostUsernameOverride:this.props.enablePostUsernameOverride,enablePostIconOverride:this.props.enablePostIconOverride}):m.createElement(I.Z,null)}}$t(sa,"propTypes",{hookId:u().string.isRequired,actions:u().shape({updateOutgoingHook:u().func.isRequired,getOutgoingHook:u().func.isRequired}).isRequired,enableOutgoingWebhooks:u().bool,enablePostUsernameOverride:u().bool.isRequired,enablePostIconOverride:u().bool.isRequired});const na=(0,s.connect)((function(e,t){const a=(0,i.iE)(e),s=new URLSearchParams(t.location.search).get("id"),n="true"===a.EnableOutgoingWebhooks,o="true"===a.EnablePostUsernameOverride,r="true"===a.EnablePostIconOverride;return{hookId:s,hook:e.entities.integrations.outgoingHooks[s],enableOutgoingWebhooks:n,enablePostUsernameOverride:o,enablePostIconOverride:r}}),(function(e){return{actions:(0,p.bindActionCreators)({updateOutgoingHook:b.z0,getOutgoingHook:b.f5},e)}}))(sa);function oa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a(39714);const ra="***************";function ia(e,t){return!t||e.name.toLowerCase().includes(t)}class la extends m.PureComponent{constructor(e){super(e),oa(this,"handleShowClientSecret",(e=>{e&&e.preventDefault&&e.preventDefault(),this.setState({clientSecret:this.props.oauthApp.client_secret})})),oa(this,"handleHideClientSecret",(e=>{e.preventDefault(),this.setState({clientSecret:ra})})),oa(this,"handleRegenerate",(e=>{e.preventDefault(),this.props.onRegenerateSecret(this.props.oauthApp.id).then((e=>{let{error:t}=e;t?this.setState({error:t.message}):(this.setState({error:null}),this.handleShowClientSecret())}))})),oa(this,"handleDelete",(()=>{this.props.onDelete(this.props.oauthApp)})),this.state={clientSecret:ra}}render(){const{oauthApp:e,creatorName:t}=this.props;let a,s,n;if(this.state.error&&(a=m.createElement(me.Z,{error:this.state.error})),!ia(e,this.props.filter))return null;s=e.name?e.name:m.createElement(T.Z,{id:"installed_integrations.unnamed_oauth_app",defaultMessage:"Unnamed OAuth 2.0 Application"}),e.description&&(n=m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__description"},e.description)));const o=m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__url word-break--all"},m.createElement(T.Z,{id:"installed_integrations.callback_urls",defaultMessage:"Callback URLs: {urls}",values:{urls:e.callback_urls.join(", ")}})));let r,i,l;r=e.is_trusted?R._u("installed_oauth_apps.trusted.yes","Yes"):R._u("installed_oauth_apps.trusted.no","No"),this.state.clientSecret===ra?(i=m.createElement("button",{id:"showSecretButton",className:"style--none color--link",onClick:this.handleShowClientSecret},m.createElement(T.Z,{id:"installed_integrations.showSecret",defaultMessage:"Show Secret"})),l=m.createElement("span",{className:"item-details__token"},m.createElement(T.Z,{id:"installed_integrations.client_secret",defaultMessage:"Client Secret: **{clientSecret}**",values:{clientSecret:this.state.clientSecret}}))):(i=m.createElement("button",{id:"hideSecretButton",className:"style--none color--link",onClick:this.handleHideClientSecret},m.createElement(T.Z,{id:"installed_integrations.hideSecret",defaultMessage:"Hide Secret"})),l=m.createElement("span",{className:"item-details__token"},m.createElement(L.Z,{id:"installed_integrations.client_secret",defaultMessage:"Client Secret: **{clientSecret}**",values:{clientSecret:this.state.clientSecret}}),m.createElement(pt,{idMessage:"integrations.copy_client_secret",defaultMessage:"Copy Client Secret",value:this.state.clientSecret})));const c=m.createElement("button",{id:"regenerateSecretButton",className:"style--none color--link",onClick:this.handleRegenerate},m.createElement(T.Z,{id:"installed_integrations.regenSecret",defaultMessage:"Regenerate Secret"}));let d,u;e.icon_url&&(d=m.createElement("div",{className:"integration__icon integration-list__icon"},m.createElement("img",{alt:"get app screenshot",src:e.icon_url}))),this.props.fromApp||(u=m.createElement("div",{className:"item-actions"},i," - ",c," - ",m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/oauth2-apps/edit?id=").concat(e.id)},m.createElement(T.Z,{id:"installed_integrations.edit",defaultMessage:"Edit"}))," - ",m.createElement(qe,{modalMessage:m.createElement(T.Z,{id:"installed_oauth_apps.delete.confirm",defaultMessage:"This action permanently deletes the OAuth 2.0 application and breaks any integrations using it. Are you sure you want to delete it?"}),onDelete:this.handleDelete})));let p=m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__creation"},m.createElement(T.Z,{id:"installed_integrations.fromApp",defaultMessage:"Managed by Apps Framework"})));return this.props.fromApp||(p=m.createElement(m.Fragment,null,m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__url word-break--all"},m.createElement(L.Z,{id:"installed_oauth_apps.is_trusted",defaultMessage:"Is Trusted: **{isTrusted}**",values:{isTrusted:r}}))),m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__token"},m.createElement(L.Z,{id:"installed_integrations.client_id",defaultMessage:"Client ID: **{clientId}**",values:{clientId:e.id}}),m.createElement(pt,{idMessage:"integrations.copy_client_id",defaultMessage:"Copy Client Id",value:e.id}))),m.createElement("div",{className:"item-details__row"},l),o,m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__creation"},m.createElement(T.Z,{id:"installed_integrations.creation",defaultMessage:"Created by {creator} on {createAt, date, full}",values:{creator:t,createAt:e.create_at}}))))),m.createElement("div",{className:"backstage-list__item"},d,m.createElement("div",{className:"item-details"},m.createElement("div",{className:"item-details__row d-flex flex-column flex-md-row justify-content-between"},m.createElement("strong",{className:"item-details__name"},s),u),a,n,p))}}oa(la,"propTypes",{fromApp:u().bool.isRequired,creatorName:u().string.isRequired,onRegenerateSecret:u().func.isRequired,onDelete:u().func.isRequired,filter:u().oneOfType([u().string,u().oneOf([null])])});const ca=(0,s.connect)((function(e,t){const a=t.oauthApp||{};return{creatorName:(0,R.hI)(e,(0,o.PR)(e,a.creator_id))}}))(la);function ma(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class da extends m.PureComponent{constructor(e){super(e),ma(this,"deleteOAuthApp",(e=>{e&&e.id&&this.props.actions.deleteOAuthApp(e.id)})),ma(this,"oauthApps",(e=>Object.values(this.props.oauthApps).filter((t=>ia(t,e))).sort(this.oauthAppCompare).map((e=>m.createElement(ca,{key:e.id,oauthApp:e,onRegenerateSecret:this.props.actions.regenOAuthAppSecret,onDelete:this.deleteOAuthApp,team:this.props.team,creatorName:"",fromApp:this.props.appsOAuthAppIDs.includes(e.id)}))))),this.state={loading:!0}}componentDidMount(){this.props.enableOAuthServiceProvider&&this.props.actions.loadOAuthAppsAndProfiles().then((()=>this.setState({loading:!1})))}oauthAppCompare(e,t){let a=e.name.toString();a||(a=(0,R._u)("installed_integrations.unnamed_oauth_app","Unnamed OAuth 2.0 Application"));let s=t.name.toString();return s||(s=(0,R._u)("installed_integrations.unnamed_oauth_app","Unnamed OAuth 2.0 Application")),a.localeCompare(s)}render(){let e;return this.props.enableOAuthServiceProvider&&this.props.canManageOauth&&(e={addLink:"/"+this.props.team.name+"/integrations/oauth2-apps/add",addText:(0,R._u)("installed_oauth_apps.add","Add OAuth 2.0 Application"),addButtonId:"addOauthApp"}),m.createElement(U,Object.assign({header:m.createElement(T.Z,{id:"installed_oauth_apps.header",defaultMessage:"OAuth 2.0 Applications"}),helpText:m.createElement(T.Z,{id:"installed_oauth_apps.help",defaultMessage:"Create {oauthApplications} to securely integrate bots and third-party apps with Mattermost. Visit the {appDirectory} to find available self-hosted apps.",values:{oauthApplications:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://developers.mattermost.com/integrate/admin-guide/admin-oauth2/"},m.createElement(T.Z,{id:"installed_oauth_apps.help.oauthApplications",defaultMessage:"OAuth 2.0 applications"})),appDirectory:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mattermost.com/marketplace/"},m.createElement(T.Z,{id:"installed_oauth_apps.help.appDirectory",defaultMessage:"App Directory"}))}}),emptyText:m.createElement(T.Z,{id:"installed_oauth_apps.empty",defaultMessage:"No OAuth 2.0 Applications found"}),emptyTextSearch:m.createElement(L.Z,{id:"installed_oauth_apps.emptySearch",defaultMessage:"No OAuth 2.0 Applications match {searchTerm}"}),searchPlaceholder:(0,R._u)("installed_oauth_apps.search","Search OAuth 2.0 Applications"),loading:this.state.loading},e),(e=>{const t=this.oauthApps(e);return[t,t.length>0]}))}}ma(da,"propTypes",{team:u().shape({name:u().string.isRequired}).isRequired,appsOAuthAppIDs:u().arrayOf(u().string).isRequired,canManageOauth:u().bool.isRequired,enableOAuthServiceProvider:u().bool.isRequired,actions:u().shape({loadOAuthAppsAndProfiles:u().func.isRequired,regenOAuthAppSecret:u().func.isRequired,deleteOAuthApp:u().func.isRequired}).isRequired});const ua=(0,s.connect)((function(e){const t="true"===(0,i.iE)(e).EnableOAuthServiceProvider;return{canManageOauth:(0,l.AN)(e,{permission:c.Pl.MANAGE_OAUTH}),oauthApps:w(e),appsOAuthAppIDs:C(e),enableOAuthServiceProvider:t,team:(0,r.kA)(e)}}),(function(e){return{actions:(0,p.bindActionCreators)({loadOAuthAppsAndProfiles:mt,regenOAuthAppSecret:b.H,deleteOAuthApp:b.qu},e)}}))(da);function pa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class ha extends m.PureComponent{constructor(e){super(e),pa(this,"getStateFromApp",(e=>({name:e.name||"",description:e.description||"",homepage:e.homepage||"",icon_url:e.icon_url||"",callbackUrls:e.callback_urls?e.callback_urls.join("\n"):"",is_trusted:e.is_trusted||!1,has_icon:Boolean(e.icon_url),saving:!1,clientError:null}))),pa(this,"imageLoaded",(()=>{this.setState({has_icon:!0,icon_url:this.icon_url.current.value})})),pa(this,"handleSubmit",(e=>{if(e.preventDefault(),this.state.saving)return;if(this.setState({saving:!0,clientError:""}),!this.state.name)return void this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_oauth_app.nameRequired",defaultMessage:"Name for the OAuth 2.0 application is required."})});if(!this.state.description)return void this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_oauth_app.descriptionRequired",defaultMessage:"Description for the OAuth 2.0 application is required."})});if(!this.state.homepage)return void this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_oauth_app.homepageRequired",defaultMessage:"Homepage for the OAuth 2.0 application is required."})});const t=[];for(let e of this.state.callbackUrls.split("\n"))e=e.trim(),e.length>0&&t.push(e);if(0===t.length)return void this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_oauth_app.callbackUrlsRequired",defaultMessage:"One or more callback URLs are required."})});const a={name:this.state.name,callback_urls:t,homepage:this.state.homepage,description:this.state.description,is_trusted:this.state.is_trusted,icon_url:this.state.icon_url};this.props.action(a).then((()=>this.setState({saving:!1})))})),pa(this,"updateName",(e=>{this.setState({name:e.target.value})})),pa(this,"updateTrusted",(e=>{this.setState({is_trusted:"true"===e.target.value})})),pa(this,"updateDescription",(e=>{this.setState({description:e.target.value})})),pa(this,"updateHomepage",(e=>{this.setState({homepage:e.target.value})})),pa(this,"updateIconUrl",(e=>{this.setState({has_icon:!1,icon_url:e.target.value}),this.image.src=e.target.value})),pa(this,"updateCallbackUrls",(e=>{this.setState({callbackUrls:e.target.value})})),this.image=new Image,this.image.onload=this.imageLoaded,this.icon_url=m.createRef(),this.state=this.getStateFromApp(this.props.initialApp||{})}render(){const e=this.props.header,t=this.props.footer,a=this.props.renderExtra;let s;this.state.has_icon&&(s=m.createElement("div",{className:"integration__icon"},m.createElement("img",{alt:"integration icon",src:this.state.icon_url})));const n=m.createElement(Ne.Z,{permissions:[c.Pl.MANAGE_SYSTEM]},m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"is_trusted"},m.createElement(T.Z,{id:"installed_oauth_apps.trusted",defaultMessage:"Is Trusted"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("label",{className:"radio-inline"},m.createElement("input",{type:"radio",value:"true",name:"is_trusted",checked:this.state.is_trusted,onChange:this.updateTrusted}),m.createElement(T.Z,{id:"installed_oauth_apps.trusted.yes",defaultMessage:"Yes"})),m.createElement("label",{className:"radio-inline"},m.createElement("input",{type:"radio",value:"false",name:"is_trusted",checked:!this.state.is_trusted,onChange:this.updateTrusted}),m.createElement(T.Z,{id:"installed_oauth_apps.trusted.no",defaultMessage:"No"})),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_oauth_app.trusted.help",defaultMessage:"If true, the OAuth 2.0 application is considered trusted by the Mattermost server and does not require the user to accept authorization. If false, a window opens to ask the user to accept or deny the authorization."})))));return m.createElement("div",{className:"backstage-content"},m.createElement(re,null,m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/oauth2-apps")},m.createElement(T.Z,{id:"installed_oauth_apps.header",defaultMessage:"Installed OAuth2 Apps"})),m.createElement(T.Z,{id:e.id,defaultMessage:e.defaultMessage})),m.createElement("div",{className:"backstage-form"},s,m.createElement("form",{className:"form-horizontal"},n,m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"name"},m.createElement(T.Z,{id:"installed_oauth_apps.name",defaultMessage:"Display Name"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"name",type:"text",maxLength:"64",className:"form-control",value:this.state.name,onChange:this.updateName}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_oauth_app.name.help",defaultMessage:"Specify the display name, of up to 64 characters, for your OAuth 2.0 application."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.createElement(T.Z,{id:"installed_oauth_apps.description",defaultMessage:"Description"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"description",type:"text",maxLength:"512",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_oauth_app.description.help",defaultMessage:"Describe your OAuth 2.0 application."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"homepage"},m.createElement(T.Z,{id:"installed_oauth_apps.homepage",defaultMessage:"Homepage"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"homepage",type:"url",maxLength:"256",className:"form-control",value:this.state.homepage,onChange:this.updateHomepage}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_oauth_app.homepage.help",defaultMessage:"This is the URL for the homepage of the OAuth 2.0 application. Depending on your server configuration, use HTTP or HTTPS in the URL."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"icon_url"},m.createElement(T.Z,{id:"installed_oauth_apps.iconUrl",defaultMessage:"Icon URL"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"icon_url",ref:this.icon_url,type:"url",maxLength:"512",className:"form-control",value:this.state.icon_url,onChange:this.updateIconUrl}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_oauth_app.icon.help",defaultMessage:"(Optional) The URL of the image used for your OAuth 2.0 application. Make sure you use HTTP or HTTPS in your URL."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"callbackUrls"},m.createElement(T.Z,{id:"installed_oauth_apps.callbackUrls",defaultMessage:"Callback URLs (One Per Line)"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("textarea",{id:"callbackUrls",rows:"3",maxLength:"1024",className:"form-control",value:this.state.callbackUrls,onChange:this.updateCallbackUrls}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_oauth_app.callbackUrls.help",defaultMessage:"The redirect URIs to which the service will redirect users after accepting or denying authorization of your application, and which will handle authorization codes or access tokens. Must be a valid URL and start with http:// or https://."})))),m.createElement("div",{className:"backstage-form__footer"},m.createElement(me.Z,{type:"backstage",errors:[this.props.serverError,this.state.clientError]}),m.createElement(P.Link,{className:"btn btn-link btn-sm",to:"/".concat(this.props.team.name,"/integrations/oauth2-apps")},m.createElement(T.Z,{id:"installed_oauth_apps.cancel",defaultMessage:"Cancel"})),m.createElement(ce.Z,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:(0,R._u)(this.props.loading.id,this.props.loading.defaultMessage),onClick:this.handleSubmit,id:"saveOauthApp"},m.createElement(T.Z,{id:t.id,defaultMessage:t.defaultMessage})),a))))}}function ga(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}pa(ha,"propTypes",{team:u().object.isRequired,header:u().object.isRequired,footer:u().object.isRequired,loading:u().object.isRequired,renderExtra:u().node.isRequired,serverError:u().string.isRequired,initialApp:u().object,action:u().func.isRequired});const ba={id:(0,oe.t)("add_oauth_app.header"),defaultMessage:"Add"},fa={id:(0,oe.t)("installed_oauth_apps.save"),defaultMessage:"Save"},Ea={id:(0,oe.t)("installed_oauth_apps.saving"),defaultMessage:"Saving..."};class _a extends m.PureComponent{constructor(e){super(e),ga(this,"addOAuthApp",(async e=>{this.setState({serverError:""});const{data:t,error:a}=await this.props.actions.addOAuthApp(e);t?se.m.push("/".concat(this.props.team.name,"/integrations/confirm?type=oauth2-apps&id=").concat(t.id)):a&&this.setState({serverError:a.message})})),this.state={serverError:""}}render(){return m.createElement(ha,{team:this.props.team,header:ba,footer:fa,loading:Ea,renderExtra:"",action:this.addOAuthApp,serverError:this.state.serverError})}}ga(_a,"propTypes",{team:u().object,addOAuthAppRequest:u().object.isRequired,actions:u().shape({addOAuthApp:u().func.isRequired}).isRequired});const ka=(0,s.connect)(null,(function(e){return{actions:(0,p.bindActionCreators)({addOAuthApp:b.eo},e)}}))(_a);function va(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const ya={id:"integrations.edit",defaultMessage:"Edit"},Na={id:"update_incoming_webhook.update",defaultMessage:"Update"},Ma={id:"update_incoming_webhook.updating",defaultMessage:"Updating..."};class wa extends m.PureComponent{constructor(e){super(e),va(this,"newApp",void 0),va(this,"editOAuthApp",(async e=>{this.newApp=e,this.props.oauthApp.id&&(e.id=this.props.oauthApp.id),!1===(this.props.oauthApp.callback_urls.length===e.callback_urls.length&&this.props.oauthApp.callback_urls.every(((t,a)=>t===e.callback_urls[a])))?this.handleConfirmModal():await this.submitOAuthApp()})),va(this,"handleConfirmModal",(()=>{this.setState({showConfirmModal:!0})})),va(this,"confirmModalDismissed",(()=>{this.setState({showConfirmModal:!1})})),va(this,"submitOAuthApp",(async()=>{this.setState({serverError:""});const e=await this.props.actions.editOAuthApp(this.newApp);if("data"in e&&e.data)se.m.push("/".concat(this.props.team.name,"/integrations/oauth2-apps"));else if(this.setState({showConfirmModal:!1}),"error"in e){const{error:t}=e;this.setState({serverError:t.message})}})),va(this,"renderExtra",(()=>{const e=m.createElement(T.Z,{id:"update_command.update",defaultMessage:"Update"}),t=m.createElement(T.Z,{id:"update_oauth_app.confirm",defaultMessage:"Edit OAuth 2.0 application"}),a=m.createElement(T.Z,{id:"update_oauth_app.question",defaultMessage:"Your changes may break the existing OAuth 2.0 application. Are you sure you would like to update it?"});return m.createElement(W.Z,{title:t,message:a,confirmButtonText:e,show:this.state.showConfirmModal,onConfirm:this.submitOAuthApp,onCancel:this.confirmModalDismissed})})),this.state={showConfirmModal:!1,serverError:""},this.newApp=this.props.oauthApp}componentDidMount(){this.props.enableOAuthServiceProvider&&this.props.actions.getOAuthApp(this.props.oauthAppId)}render(){return this.props.oauthApp?m.createElement(ha,{team:this.props.team,header:ya,footer:Na,loading:Ma,renderExtra:this.renderExtra(),action:this.editOAuthApp,serverError:this.state.serverError,initialApp:this.props.oauthApp}):m.createElement(I.Z,null)}}va(wa,"propTypes",{oauthAppId:u().string.isRequired,actions:u().shape({getOAuthApp:u().func.isRequired,editOAuthApp:u().func.isRequired}).isRequired,enableOAuthServiceProvider:u().bool.isRequired});const Ca=(0,s.connect)((function(e,t){const a=(0,i.iE)(e),s=new URLSearchParams(t.location.search).get("id")||"",n="true"===a.EnableOAuthServiceProvider;return{oauthAppId:s,oauthApp:e.entities.integrations.oauthApps[s],enableOAuthServiceProvider:n}}),(function(e){return{actions:(0,p.bindActionCreators)({getOAuthApp:b.oh,editOAuthApp:b.N4},e)}}))(wa);function Aa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Oa(e,t){return!t||-1!==e.display_name.toLowerCase().indexOf(t)||-1!==e.description.toLowerCase().indexOf(t)||-1!==e.trigger.toLowerCase().indexOf(t)}class Sa extends m.PureComponent{constructor(){super(...arguments),Aa(this,"handleRegenToken",(e=>{e.preventDefault(),this.props.onRegenToken(this.props.command)})),Aa(this,"handleDelete",(()=>{this.props.onDelete(this.props.command)}))}render(){const e=this.props.command;if(!Oa(e,this.props.filter?this.props.filter.toLowerCase():""))return null;let t;t=e.display_name?e.display_name:m.createElement(T.Z,{id:"installed_commands.unnamed_command",defaultMessage:"Unnamed Slash Command"});let a=null;e.description&&(a=m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__description"},e.description)));let s="- /"+e.trigger;e.auto_complete&&e.auto_complete_hint&&(s+=" "+e.auto_complete_hint);let n=null;this.props.canChange&&(n=m.createElement("div",{className:"item-actions"},m.createElement("button",{className:"style--none color--link",onClick:this.handleRegenToken},m.createElement(T.Z,{id:"installed_integrations.regenToken",defaultMessage:"Regenerate Token"}))," - ",m.createElement(P.Link,{to:"/".concat(this.props.team.name,"/integrations/commands/edit?id=").concat(e.id)},m.createElement(T.Z,{id:"installed_integrations.edit",defaultMessage:"Edit"}))," - ",m.createElement(qe,{modalMessage:m.createElement(T.Z,{id:"installed_commands.delete.confirm",defaultMessage:"This action permanently deletes the slash command and breaks any integrations using it. Are you sure you want to delete it?"}),onDelete:this.handleDelete})));const o=e.token;return m.createElement("div",{className:"backstage-list__item"},m.createElement("div",{className:"item-details"},m.createElement("div",{className:"item-details__row d-flex flex-column flex-md-row justify-content-between"},m.createElement("div",null,m.createElement("strong",{className:"item-details__name"},t),m.createElement("span",{className:"item-details__trigger"},s)),n),a,m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__token"},m.createElement(T.Z,{id:"installed_integrations.token",defaultMessage:"Token: {token}",values:{token:o}}),m.createElement(pt,{value:o}))),m.createElement("div",{className:"item-details__row"},m.createElement("span",{className:"item-details__creation"},m.createElement(T.Z,{id:"installed_integrations.creation",defaultMessage:"Created by {creator} on {createAt, date, full}",values:{creator:this.props.creator.username,createAt:e.create_at}})))))}}function Ta(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Aa(Sa,"propTypes",{team:u().object.isRequired,command:u().object.isRequired,onRegenToken:u().func.isRequired,onDelete:u().func.isRequired,filter:u().string,creator:u().object.isRequired,canChange:u().bool.isRequired});class Za extends m.PureComponent{constructor(){super(...arguments),Ta(this,"regenCommandToken",(e=>{this.props.actions.regenCommandToken(e.id)})),Ta(this,"deleteCommand",(e=>{this.props.actions.deleteCommand(e.id)}))}commandCompare(e,t){let a=e.display_name;a||(a=R._u("installed_commands.unnamed_command","Unnamed Slash Command"));let s=t.display_name;return s||(s=R._u("installed_commands.unnamed_command","Unnamed Slash Command")),a.localeCompare(s)}render(){const e=e=>this.props.commands.filter((e=>e.team_id===this.props.team.id)).filter((t=>Oa(t,e))).sort(this.commandCompare).map((e=>{const t=this.props.canManageOthersSlashCommands||this.props.user.id===e.creator_id;return m.createElement(Sa,{key:e.id,team:this.props.team,command:e,onRegenToken:this.regenCommandToken,onDelete:this.deleteCommand,creator:this.props.users[e.creator_id]||{},canChange:t})}));return m.createElement(U,{header:m.createElement(T.Z,{id:"installed_commands.header",defaultMessage:"Installed Slash Commands"}),addText:m.createElement(T.Z,{id:"installed_commands.add",defaultMessage:"Add Slash Command"}),addLink:"/"+this.props.team.name+"/integrations/commands/add",addButtonId:"addSlashCommand",emptyText:m.createElement(T.Z,{id:"installed_commands.empty",defaultMessage:"No slash commands found"}),emptyTextSearch:m.createElement(L.Z,{id:"installed_commands.emptySearch",defaultMessage:"No slash commands match {searchTerm}"}),helpText:m.createElement(T.Z,{id:"installed_commands.help",defaultMessage:"Use slash commands to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.",values:{buildYourOwn:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://developers.mattermost.com/integrate/admin-guide/admin-slash-commands/"},m.createElement(T.Z,{id:"installed_commands.help.buildYourOwn",defaultMessage:"Build Your Own"})),appDirectory:m.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mattermost.com/marketplace"},m.createElement(T.Z,{id:"installed_commands.help.appDirectory",defaultMessage:"App Directory"}))}}),searchPlaceholder:R._u("installed_commands.search","Search Slash Commands"),loading:this.props.loading},(t=>{const a=e(t);return[a,a.length>0]}))}}Ta(Za,"propTypes",{commands:u().array.isRequired,loading:u().bool.isRequired,canManageOthersSlashCommands:u().bool.isRequired,actions:u().shape({regenCommandToken:u().func.isRequired,deleteCommand:u().func.isRequired}).isRequired});const Ra=(0,s.connect)((function(e,t){return{canManageOthersSlashCommands:(0,l.Rm)(e,t.team.id,c.Pl.MANAGE_OTHERS_SLASH_COMMANDS)}}),(function(e){return{actions:(0,p.bindActionCreators)({regenCommandToken:b.kq,deleteCommand:b.JL},e)}}))(Za);function Pa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Ia extends m.PureComponent{constructor(e){super(e),Pa(this,"getStateFromCommand",(e=>({displayName:e.display_name||"",description:e.description||"",trigger:e.trigger||"",url:e.url||"",method:e.method||"P",username:e.username||"",iconUrl:e.icon_url||"",autocomplete:e.auto_complete||!1,autocompleteHint:e.auto_complete_hint||"",autocompleteDescription:e.auto_complete_desc||"",saving:!1,clientError:null}))),Pa(this,"handleSubmit",(e=>{if(e.preventDefault(),this.state.saving)return;this.setState({saving:!0,clientError:""});let t=this.state.trigger.trim().toLowerCase();0===t.indexOf("/")&&(t=t.substr(1));const a={display_name:this.state.displayName,description:this.state.description,trigger:t,url:this.state.url.trim(),method:this.state.method,username:this.state.username,icon_url:this.state.iconUrl,auto_complete:this.state.autocomplete,team_id:this.props.team.id};a.auto_complete&&(a.auto_complete_desc=this.state.autocompleteDescription,a.auto_complete_hint=this.state.autocompleteHint),a.trigger?0!==a.trigger.indexOf("/")?-1===a.trigger.indexOf(" ")?a.trigger.length<D.ZP.MIN_TRIGGER_LENGTH||a.trigger.length>D.ZP.MAX_TRIGGER_LENGTH?this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_command.triggerInvalidLength",defaultMessage:"A trigger word must contain between {min} and {max} characters",values:{min:D.ZP.MIN_TRIGGER_LENGTH,max:D.ZP.MAX_TRIGGER_LENGTH}})}):a.url?this.props.action(a).then((()=>this.setState({saving:!1}))):this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_command.urlRequired",defaultMessage:"A request URL is required"})}):this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_command.triggerInvalidSpace",defaultMessage:"A trigger word must not contain spaces"})}):this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_command.triggerInvalidSlash",defaultMessage:"A trigger word cannot begin with a /"})}):this.setState({saving:!1,clientError:m.createElement(T.Z,{id:"add_command.triggerRequired",defaultMessage:"A trigger word is required"})})})),Pa(this,"updateDisplayName",(e=>{this.setState({displayName:e.target.value})})),Pa(this,"updateDescription",(e=>{this.setState({description:e.target.value})})),Pa(this,"updateTrigger",(e=>{this.setState({trigger:e.target.value})})),Pa(this,"updateUrl",(e=>{this.setState({url:e.target.value})})),Pa(this,"updateMethod",(e=>{this.setState({method:e.target.value})})),Pa(this,"updateUsername",(e=>{this.setState({username:e.target.value})})),Pa(this,"updateIconUrl",(e=>{this.setState({iconUrl:e.target.value})})),Pa(this,"updateAutocomplete",(e=>{this.setState({autocomplete:e.target.checked})})),Pa(this,"updateAutocompleteHint",(e=>{this.setState({autocompleteHint:e.target.value})})),Pa(this,"updateAutocompleteDescription",(e=>{this.setState({autocompleteDescription:e.target.value})})),this.state=this.getStateFromCommand(this.props.initialCommand||{})}render(){let e=null,t=null;return this.state.autocomplete&&(e=m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocompleteHint"},m.createElement(T.Z,{id:"add_command.autocompleteHint",defaultMessage:"Autocomplete Hint"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement(Ge.Z,{id:"autocompleteHint",type:"text",maxLength:"1024",className:"form-control",value:this.state.autocompleteHint,onChange:this.updateAutocompleteHint,placeholder:{id:(0,oe.t)("add_command.autocompleteHint.placeholder"),defaultMessage:"Example: [Patient Name]"}}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.autocompleteHint.help",defaultMessage:"(Optional) Specify the arguments associated with your slash command. These are displayed as help on the autocomplete list."})))),t=m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocompleteDescription"},m.createElement(T.Z,{id:"add_command.autocompleteDescription",defaultMessage:"Autocomplete Description"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement(Ge.Z,{id:"description",type:"text",maxLength:"128",className:"form-control",value:this.state.autocompleteDescription,onChange:this.updateAutocompleteDescription,placeholder:{id:(0,oe.t)("add_command.autocompleteDescription.placeholder"),defaultMessage:'Example: "Returns search results for patient records"'}}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.autocompleteDescription.help",defaultMessage:"(Optional) Describe your slash command for the autocomplete list."}))))),m.createElement("div",{className:"backstage-content row"},m.createElement(re,null,m.createElement(P.Link,{to:"/"+this.props.team.name+"/integrations/commands"},m.createElement(T.Z,{id:"installed_command.header",defaultMessage:"Slash Commands"})),m.createElement(T.Z,{id:this.props.header.id,defaultMessage:this.props.header.defaultMessage})),m.createElement("div",{className:"backstage-form"},m.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},m.createElement(T.Z,{id:"add_command.displayName",defaultMessage:"Title"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.displayName.help",defaultMessage:"Specify a title, of up to 64 characters, for the slash command settings page."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.createElement(T.Z,{id:"add_command.description",defaultMessage:"Description"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("input",{id:"description",type:"text",maxLength:"128",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.description.help",defaultMessage:"Describe your incoming webhook."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"trigger"},m.createElement(T.Z,{id:"add_command.trigger",defaultMessage:"Command Trigger Word"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement(Ge.Z,{id:"trigger",type:"text",maxLength:D.ZP.MAX_TRIGGER_LENGTH,className:"form-control",value:this.state.trigger,onChange:this.updateTrigger,placeholder:{id:(0,oe.t)("add_command.trigger.placeholder"),defaultMessage:'Command trigger e.g. "hello" not including the slash'}}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.trigger.help",defaultMessage:"Specify a trigger word that is not a built-in command, does not contain spaces, and does not begin with the slash character."})),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.trigger.helpExamples",defaultMessage:"Examples: client, employee, patient, weather"})),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.trigger.helpReserved",defaultMessage:"Reserved: {link}",values:{link:m.createElement("a",{href:"https://developers.mattermost.com/integrate/admin-guide/admin-slash-commands/#built-in-commands",target:"_blank",rel:"noopener noreferrer"},m.createElement(T.Z,{id:"add_command.trigger.helpReservedLinkText",defaultMessage:"See built-in slash commands"}))}})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"url"},m.createElement(T.Z,{id:"add_command.url",defaultMessage:"Request URL"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement(Ge.Z,{id:"url",type:"text",maxLength:"1024",className:"form-control",value:this.state.url,onChange:this.updateUrl,placeholder:{id:(0,oe.t)("add_command.url.placeholder"),defaultMessage:"Must start with http:// or https://"}}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.url.help",defaultMessage:"Specify the callback URL to receive the HTTP POST or GET event request when the slash command is run."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"method"},m.createElement(T.Z,{id:"add_command.method",defaultMessage:"Request Method"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement("select",{id:"method",className:"form-control",value:this.state.method,onChange:this.updateMethod},m.createElement("option",{value:"P"},R._u("add_command.method.post","POST")),m.createElement("option",{value:"G"},R._u("add_command.method.get","GET"))),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.method.help",defaultMessage:"Specify the type of request, either POST or GET, sent to the endpoint that Mattermost hits to reach your application."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},m.createElement(T.Z,{id:"add_command.username",defaultMessage:"Response Username"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement(Ge.Z,{id:"username",type:"text",maxLength:"64",className:"form-control",value:this.state.username,onChange:this.updateUsername,placeholder:{id:(0,oe.t)("add_command.username.placeholder"),defaultMessage:"Username"}}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.username.help",defaultMessage:'(Optional) Specify the name to use when posting responses for this slash command. Usernames can be up to 22 characters, and contain lowercase letters, numbers, and the symbols \\"-\\", \\"_\\", and \\".\\". If left blank, your Mattermost username is used.'})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"iconUrl"},m.createElement(T.Z,{id:"add_command.iconUrl",defaultMessage:"Response Icon"})),m.createElement("div",{className:"col-md-5 col-sm-8"},m.createElement(Ge.Z,{id:"iconUrl",type:"text",maxLength:"1024",className:"form-control",value:this.state.iconUrl,onChange:this.updateIconUrl,placeholder:{id:(0,oe.t)("add_command.iconUrl.placeholder"),defaultMessage:"https://www.example.com/myicon.png"}}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.iconUrl.help",defaultMessage:"(Optional) Enter the URL of a .png or .jpg file to use as the icon when posting responses to this slash command. The file must be at least 128 pixels by 128 pixels. If left blank, your profile picture is used."})))),m.createElement("div",{className:"form-group"},m.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocomplete"},m.createElement(T.Z,{id:"add_command.autocomplete",defaultMessage:"Autocomplete"})),m.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},m.createElement("input",{id:"autocomplete",type:"checkbox",checked:this.state.autocomplete,onChange:this.updateAutocomplete}),m.createElement("div",{className:"form__help"},m.createElement(T.Z,{id:"add_command.autocomplete.help",defaultMessage:'(Optional) Show your slash command on the autocomplete list when someone types "/" in the input box.'})))),e,t,m.createElement("div",{className:"backstage-form__footer"},m.createElement(me.Z,{type:"backstage",errors:[this.props.serverError,this.state.clientError]}),m.createElement(P.Link,{className:"btn btn-link btn-sm",to:"/"+this.props.team.name+"/integrations/commands"},m.createElement(T.Z,{id:"add_command.cancel",defaultMessage:"Cancel"})),m.createElement(ce.Z,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:R._u(this.props.loading.id,this.props.loading.defaultMessage),onClick:this.handleSubmit,id:"saveCommand"},m.createElement(T.Z,{id:this.props.footer.id,defaultMessage:this.props.footer.defaultMessage})),this.props.renderExtra))))}}function xa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Pa(Ia,"propTypes",{team:u().object.isRequired,header:u().object.isRequired,footer:u().object.isRequired,loading:u().object.isRequired,renderExtra:u().node.isRequired,serverError:u().string.isRequired,initialCommand:u().object,action:u().func.isRequired});const ja={id:(0,oe.t)("integrations.add"),defaultMessage:"Add"},Ua={id:(0,oe.t)("add_command.save"),defaultMessage:"Save"},qa={id:(0,oe.t)("add_command.saving"),defaultMessage:"Saving..."};class Da extends m.PureComponent{constructor(e){super(e),xa(this,"addCommand",(async e=>{this.setState({serverError:""});const{data:t,error:a}=await this.props.actions.addCommand(e);t?se.m.push("/".concat(this.props.team.name,"/integrations/commands/confirm?type=commands&id=").concat(t.id)):a&&this.setState({serverError:a.message})})),this.state={serverError:""}}render(){return m.createElement(Ia,{team:this.props.team,header:ja,footer:Ua,loading:qa,renderExtra:"",action:this.addCommand,serverError:this.state.serverError})}}xa(Da,"propTypes",{team:u().object,actions:u().shape({addCommand:u().func.isRequired}).isRequired});const La=(0,s.connect)(null,(function(e){return{actions:(0,p.bindActionCreators)({addCommand:b.OH},e)}}))(Da);function Wa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Ha={id:(0,oe.t)("integrations.edit"),defaultMessage:"Edit"},Ba={id:(0,oe.t)("edit_command.update"),defaultMessage:"Update"},Fa={id:(0,oe.t)("edit_command.updating"),defaultMessage:"Updating..."};class Ga extends m.PureComponent{constructor(e){super(e),Wa(this,"newCommand",void 0),Wa(this,"editCommand",(async e=>{var t,a,s,n;this.newCommand=e,null!==(t=this.state.originalCommand)&&void 0!==t&&t.id&&(e.id=this.state.originalCommand.id),(null===(a=this.state.originalCommand)||void 0===a?void 0:a.url)!==this.newCommand.url||(null===(s=this.state.originalCommand)||void 0===s?void 0:s.trigger)!==this.newCommand.trigger||(null===(n=this.state.originalCommand)||void 0===n?void 0:n.method)!==this.newCommand.method?this.handleConfirmModal():await this.submitCommand()})),Wa(this,"handleConfirmModal",(()=>{this.setState({showConfirmModal:!0})})),Wa(this,"confirmModalDismissed",(()=>{this.setState({showConfirmModal:!1})})),Wa(this,"submitCommand",(async()=>{this.setState({serverError:""});const{data:e,error:t}=await this.props.actions.editCommand(this.newCommand);e?se.m.push("/".concat(this.props.team.name,"/integrations/commands")):(this.setState({showConfirmModal:!1}),t&&this.setState({serverError:t.message}))})),Wa(this,"renderExtra",(()=>{const e=m.createElement(T.Z,{id:"update_command.update",defaultMessage:"Update"}),t=m.createElement(T.Z,{id:"update_command.confirm",defaultMessage:"Edit Slash Command"}),a=m.createElement(T.Z,{id:"update_command.question",defaultMessage:"Your changes may break the existing slash command. Are you sure you would like to update it?"});return m.createElement(W.Z,{title:t,message:a,confirmButtonText:e,show:this.state.showConfirmModal,onConfirm:this.submitCommand,onCancel:this.confirmModalDismissed})})),this.newCommand=void 0,this.state={originalCommand:null,showConfirmModal:!1,serverError:""}}componentDidMount(){this.props.enableCommands&&this.props.actions.getCustomTeamCommands(this.props.team.id).then((()=>{this.setState({originalCommand:Object.values(this.props.commands).filter((e=>e.id===this.props.commandId))[0]})}))}render(){return this.state.originalCommand?m.createElement(Ia,{team:this.props.team,header:Ha,footer:Ba,loading:Fa,renderExtra:this.renderExtra(),action:this.editCommand,serverError:this.state.serverError,initialCommand:this.state.originalCommand}):m.createElement(I.Z,null)}}Wa(Ga,"propTypes",{commandId:u().oneOfType([u().string,u().oneOf([null])]),actions:u().shape({getCustomTeamCommands:u().func.isRequired,editCommand:u().func.isRequired}).isRequired,enableCommands:u().bool.isRequired});const Ya=(0,s.connect)((function(e,t){const a=(0,i.iE)(e),s=new URLSearchParams(t.location.search).get("id"),n="true"===a.EnableCommands;return{commandId:s,commands:M(e),enableCommands:n}}),(function(e){return{actions:(0,p.bindActionCreators)({getCustomTeamCommands:b.cC,editCommand:b.h0},e)}}))(Ga);a(15306);class za extends m.PureComponent{static get propTypes(){return{team:u().object,location:u().object,commands:u().object,oauthApps:u().object,incomingHooks:u().object,outgoingHooks:u().object,bots:u().object}}constructor(e){super(e),function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(this,"handleKeyPress",(e=>{"Enter"===e.key&&se.m.push("/"+this.props.team.name+"/integrations/"+this.state.type)})),this.state={type:new URLSearchParams(this.props.location.search).get("type"),id:new URLSearchParams(this.props.location.search).get("id")}}componentDidMount(){window.addEventListener("keypress",this.handleKeyPress)}componentWillUnmount(){window.removeEventListener("keypress",this.handleKeyPress)}render(){let e=null,t=null,a=null;const s=this.props.commands[this.state.id],n=this.props.incomingHooks[this.state.id],o=this.props.outgoingHooks[this.state.id],r=this.props.oauthApps[this.state.id],i=this.props.bots[this.state.id];if(this.state.type===D.gT.Integrations.COMMAND&&s){const n=s.token;e=m.createElement(T.Z,{id:"installed_commands.header",defaultMessage:"Slash Commands"}),t=m.createElement("p",null,m.createElement(T.Z,{id:"add_command.doneHelp",defaultMessage:"Your slash command is set up. The following token will be sent in the outgoing payload. Please use it to verify the request came from your Mattermost team (details at <link>Slash Commands</link>).",values:{link:e=>m.createElement("a",{href:"https://developers.mattermost.com/integrate/admin-guide/admin-slash-commands/",referrer:"noreferrer",target:"_blank",rel:"noreferrer"},e)}})),a=m.createElement("p",{className:"word-break--all"},m.createElement(L.Z,{id:"add_command.token",defaultMessage:"**Token**: {token}",values:{token:n}}),m.createElement(pt,{value:n}))}else if(this.state.type===D.gT.Integrations.INCOMING_WEBHOOK&&n){const s=(0,Z.fO)()+"/hooks/"+n.id;e=m.createElement(T.Z,{id:"installed_incoming_webhooks.header",defaultMessage:"Incoming Webhooks"}),t=m.createElement("p",null,m.createElement(T.Z,{id:"add_incoming_webhook.doneHelp",defaultMessage:"Your incoming webhook is set up. Please send data to the following URL (details at <link>Incoming Webhooks</link>).",values:{link:e=>m.createElement("a",{href:"https://developers.mattermost.com/integrate/admin-guide/admin-webhooks-incoming/",referrer:"noreferrer",target:"_blank",rel:"noreferrer"},e)}})),a=m.createElement("p",{className:"word-break--all"},m.createElement(L.Z,{id:"add_incoming_webhook.url",defaultMessage:"**URL**: {url}",values:{url:"`"+s+"`"}}),m.createElement(pt,{value:s}))}else if(this.state.type===D.gT.Integrations.OUTGOING_WEBHOOK&&o){const s=o.token;e=m.createElement(T.Z,{id:"installed_outgoing_webhooks.header",defaultMessage:"Outgoing Webhooks"}),t=m.createElement("p",null,m.createElement(T.Z,{id:"add_outgoing_webhook.doneHelp",defaultMessage:"Your outgoing webhook is set up. The following token will be sent in the outgoing payload. Please use it to verify that the request came from your Mattermost team (details at <link>Outgoing Webhooks</link>).",values:{link:e=>m.createElement("a",{href:"https://developers.mattermost.com/integrate/admin-guide/admin-webhooks-outgoing/",referrer:"noreferrer",target:"_blank",rel:"noreferrer"},e)}})),a=m.createElement("p",{className:"word-break--all"},m.createElement(L.Z,{id:"add_outgoing_webhook.token",defaultMessage:"**Token**: {token}",values:{token:s}}),m.createElement(pt,{value:s}))}else if(this.state.type===D.gT.Integrations.OAUTH_APP&&r){const s=r.id,n=r.client_secret;e=m.createElement(T.Z,{id:"installed_oauth_apps.header",defaultMessage:"OAuth 2.0 Applications"}),t=[],t.push(m.createElement("p",{key:"add_oauth_app.doneHelp"},m.createElement(L.Z,{id:"add_oauth_app.doneHelp",defaultMessage:"Your OAuth 2.0 application is set up. Please use the following Client ID and Client Secret when requesting authorization for your application (details at [oAuth 2 Applications](!https://developers.mattermost.com/integrate/admin-guide/admin-oauth2/))."}))),t.push(m.createElement("p",{key:"add_oauth_app.clientId"},m.createElement(L.Z,{id:"add_oauth_app.clientId",defaultMessage:"**Client ID**: {id}",values:{id:s}}),m.createElement(pt,{idMessage:"integrations.copy_client_id",defaultMessage:"Copy Client Id",value:s}),m.createElement("br",null),m.createElement(L.Z,{id:"add_oauth_app.clientSecret",defaultMessage:"**Client Secret**: {secret}",values:{secret:n}}),m.createElement(pt,{idMessage:"integrations.copy_client_secret",defaultMessage:"Copy Client Secret",value:n}))),t.push(m.createElement("p",{key:"add_oauth_app.doneUrlHelp"},m.createElement(T.Z,{id:"add_oauth_app.doneUrlHelp",defaultMessage:"Here are your authorized redirect URLs."}))),a=m.createElement("p",{className:"word-break--all"},m.createElement(L.Z,{id:"add_oauth_app.url",defaultMessage:"**URL(s)**: {url}",values:{url:r.callback_urls.join(", ")}}))}else{if(this.state.type!==D.gT.Integrations.BOT||!i)return se.m.replace("/error?type=".concat(D.vU.PAGE_NOT_FOUND)),"";{const s=new URLSearchParams(this.props.location.search).get("token");e=m.createElement(T.Z,{id:"bots.manage.header",defaultMessage:"Bot Accounts"}),t=m.createElement("p",null,m.createElement(L.Z,{id:"bots.manage.created.text",defaultMessage:"Your bot account **{botname}** has been created successfully. Please use the following access token to connect to the bot (see [documentation](https://mattermost.com/pl/default-bot-accounts) for further details).",values:{botname:i.display_name||i.username}})),a=m.createElement("p",{className:"word-break--all"},m.createElement(L.Z,{id:"add_outgoing_webhook.token",defaultMessage:"**Token**: {token}",values:{token:s}}),m.createElement(pt,{value:s}),m.createElement("br",null),m.createElement("br",null),m.createElement(L.Z,{id:"add_outgoing_webhook.token.message",defaultMessage:"Make sure to add this bot account to teams and channels you want it to interact in. See [documentation](https://mattermost.com/pl/default-bot-accounts) to learn more."}))}}return m.createElement("div",{className:"backstage-content row"},m.createElement(re,null,m.createElement(P.Link,{to:"/"+this.props.team.name+"/integrations/"+this.state.type},e),m.createElement(T.Z,{id:"integrations.add",defaultMessage:"Add"})),m.createElement("div",{className:"backstage-form backstage-form__confirmation"},m.createElement("h4",{className:"backstage-form__title",id:"formTitle"},m.createElement(T.Z,{id:"integrations.successful",defaultMessage:"Setup Successful"})),t,a,m.createElement("div",{className:"backstage-form__footer"},m.createElement(P.Link,{className:"btn btn-primary",type:"submit",to:"/"+this.props.team.name+"/integrations/"+this.state.type,id:"doneButton"},m.createElement(T.Z,{id:"integrations.done",defaultMessage:"Done"})))))}}const Ja=(0,s.connect)((function(e){return{commands:M(e),oauthApps:w(e),incomingHooks:y(e),outgoingHooks:N(e),bots:(0,h.Gb)(e)}}))(za),Va=["component","extraProps"];const Ka=e=>{let{component:t,extraProps:a}=e,s=function(e,t){if(null==e)return{};var a,s,n=function(e,t){if(null==e)return{};var a,s,n={},o=Object.keys(e);for(s=0;s<o.length;s++)a=o[s],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)a=o[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,Va);return m.createElement(n.AW,Object.assign({},s,{render:e=>m.createElement(t,Object.assign({},a,e))}))};Ka.propTypes={component:u().any.isRequired,extraProps:u().shape({loading:u().bool.isRequired,commands:u().array.isRequired}).isRequired,path:u().string.isRequired};class Xa extends m.PureComponent{constructor(e){super(e),this.state={loading:!0}}componentDidMount(){var e;this.props.enableCommands&&this.props.actions.loadCommandsAndProfilesForTeam(null===(e=this.props.team)||void 0===e?void 0:e.id).then((()=>this.setState({loading:!1})))}render(){const e={loading:this.state.loading,commands:this.props.commands||[],users:this.props.users,team:this.props.team,user:this.props.user};return m.createElement("div",null,m.createElement(n.rs,null,m.createElement(n.AW,{exact:!0,path:"".concat(this.props.match.url,"/"),render:()=>m.createElement(n.l_,{to:"".concat(this.props.match.url,"/installed")})}),m.createElement(Ka,{extraProps:e,path:"".concat(this.props.match.url,"/installed"),component:Ra}),m.createElement(Ka,{extraProps:e,path:"".concat(this.props.match.url,"/add"),component:La}),m.createElement(Ka,{extraProps:e,path:"".concat(this.props.match.url,"/edit"),component:Ya}),m.createElement(Ka,{extraProps:e,path:"".concat(this.props.match.url,"/confirm"),component:Ja})))}}!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Xa,"propTypes",{commands:u().array.isRequired,match:u().shape({url:u().string.isRequired}).isRequired,actions:u().shape({loadCommandsAndProfilesForTeam:u().func.isRequired}).isRequired,enableCommands:u().bool});const Qa=(0,s.connect)((function(e){const t="true"===(0,i.iE)(e).EnableCommands;return{commands:Object.values(M(e)),users:(0,o.Rf)(e),enableCommands:t}}),(function(e){return{actions:(0,p.bindActionCreators)({loadCommandsAndProfilesForTeam:ct},e)}}))(Xa);class $a extends m.PureComponent{static get propTypes(){return{name:u().string.isRequired,title:u().node.isRequired,icon:u().string.isRequired,parentLink:u().string,children:u().arrayOf(u().element)}}static get defaultProps(){return{parentLink:"",children:[]}}render(){const{name:e,title:t,icon:a,parentLink:s,children:o}=this.props,r=s+"/"+e;return m.createElement("li",{className:"backstage-sidebar__category"},m.createElement(P.NavLink,{to:r,className:"category-title",activeClassName:"category-title--active"},m.createElement("i",{className:"fa "+a}),m.createElement("span",{className:"category-title__text"},t)),o&&o.length>0&&m.createElement(n.AW,{path:r,render:()=>m.createElement("ul",{className:"sections"},m.Children.map(o,(e=>e?m.cloneElement(e,{parentLink:r}):e)))}))}}class es extends m.PureComponent{static get propTypes(){return{name:u().string.isRequired,title:u().node.isRequired,parentLink:u().string,subsection:u().bool,children:u().arrayOf(u().element),id:u().string}}static get defaultProps(){return{parentLink:"",subsection:!1,children:[]}}getLink(){return this.props.parentLink+"/"+this.props.name}render(){const{title:e,subsection:t,children:a}=this.props,s=this.getLink();let n=null;a.length>0&&(n=m.createElement("ul",{className:"subsections"},m.Children.map(a,(e=>m.cloneElement(e,{parentLink:s,subsection:!0})))));let o="section";return t&&(o="subsection"),m.createElement("li",{className:o,id:this.props.id},m.createElement(P.NavLink,{className:"".concat(o,"-title"),activeClassName:"".concat(o,"-title--active"),to:s},m.createElement("span",{className:"".concat(o,"-title__text")},e)),n)}}class ts extends m.PureComponent{static get propTypes(){return{team:u().object.isRequired,user:u().object.isRequired,enableCustomEmoji:u().bool.isRequired,enableIncomingWebhooks:u().bool.isRequired,enableOutgoingWebhooks:u().bool.isRequired,enableCommands:u().bool.isRequired,enableOAuthServiceProvider:u().bool.isRequired,canCreateOrDeleteCustomEmoji:u().bool.isRequired,canManageIntegrations:u().bool.isRequired}}renderCustomEmoji(){return this.props.enableCustomEmoji&&this.props.canCreateOrDeleteCustomEmoji?m.createElement($a,{name:"emoji",parentLink:"/"+this.props.team.name,icon:"fa-smile-o",title:m.createElement(T.Z,{id:"backstage_sidebar.emoji",defaultMessage:"Custom Emoji"})}):null}renderIntegrations(){if(!this.props.canManageIntegrations)return null;let e=null;this.props.enableIncomingWebhooks&&(e=m.createElement(Me.Z,{permissions:[c.Pl.MANAGE_INCOMING_WEBHOOKS],teamId:this.props.team.id},m.createElement(es,{name:"incoming_webhooks",parentLink:"/"+this.props.team.name+"/integrations",title:m.createElement(T.Z,{id:"backstage_sidebar.integrations.incoming_webhooks",defaultMessage:"Incoming Webhooks"}),id:"incomingWebhooks"})));let t=null;this.props.enableOutgoingWebhooks&&(t=m.createElement(Me.Z,{permissions:[c.Pl.MANAGE_OUTGOING_WEBHOOKS],teamId:this.props.team.id},m.createElement(es,{name:"outgoing_webhooks",parentLink:"/"+this.props.team.name+"/integrations",title:m.createElement(T.Z,{id:"backstage_sidebar.integrations.outgoing_webhooks",defaultMessage:"Outgoing Webhooks"}),id:"outgoingWebhooks"})));let a=null;this.props.enableCommands&&(a=m.createElement(Me.Z,{permissions:[c.Pl.MANAGE_SLASH_COMMANDS],teamId:this.props.team.id},m.createElement(es,{name:"commands",parentLink:"/"+this.props.team.name+"/integrations",title:m.createElement(T.Z,{id:"backstage_sidebar.integrations.commands",defaultMessage:"Slash Commands"}),id:"slashCommands"})));let s=null;this.props.enableOAuthServiceProvider&&(s=m.createElement(Ne.Z,{permissions:[c.Pl.MANAGE_OAUTH]},m.createElement(es,{name:"oauth2-apps",parentLink:"/"+this.props.team.name+"/integrations",title:m.createElement(T.Z,{id:"backstage_sidebar.integrations.oauthApps",defaultMessage:"OAuth 2.0 Applications"}),id:"oauthApps"})));const n=m.createElement(Ne.Z,{permissions:["manage_bots","manage_others_bots"]},m.createElement(es,{name:"bots",parentLink:"/"+this.props.team.name+"/integrations",title:m.createElement(T.Z,{id:"backstage_sidebar.bots",defaultMessage:"Bot Accounts"}),id:"botAccounts"}));return m.createElement($a,{name:"integrations",icon:"fa-link",parentLink:"/"+this.props.team.name,title:m.createElement(T.Z,{id:"backstage_sidebar.integrations",defaultMessage:"Integrations"})},e,t,a,s,n)}render(){return m.createElement("div",{className:"backstage-sidebar"},m.createElement("ul",null,this.renderCustomEmoji(),this.renderIntegrations()))}}var as=a(36192);const ss=["component","extraProps"];function ns(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const os=e=>{let{component:t,extraProps:a}=e,s=function(e,t){if(null==e)return{};var a,s,n=function(e,t){if(null==e)return{};var a,s,n={},o=Object.keys(e);for(s=0;s<o.length;s++)a=o[s],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)a=o[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,ss);return m.createElement(n.AW,Object.assign({},s,{render:e=>m.createElement(t,Object.assign({},a,e))}))};class rs extends m.PureComponent{constructor(){super(...arguments),ns(this,"scrollToTop",(()=>{this.listRef&&(this.listRef.scrollTop=0)})),ns(this,"setListRef",(e=>{this.listRef=e}))}render(){if(null==this.props.team||null==this.props.user)return m.createElement("div",null);const e={team:this.props.team,user:this.props.user,scrollToTop:this.scrollToTop};return m.createElement("div",{className:"backstage"},m.createElement(fe.Z,null),m.createElement(Ee.Z,null),m.createElement(as.Z,{team:this.props.team,siteName:this.props.siteName}),m.createElement(be.Z,{pluggableName:"Root"}),m.createElement("div",{className:"backstage-body",ref:this.setListRef},m.createElement(ts,{team:this.props.team,user:this.props.user,enableCustomEmoji:this.props.enableCustomEmoji,enableIncomingWebhooks:this.props.enableIncomingWebhooks,enableOutgoingWebhooks:this.props.enableOutgoingWebhooks,enableCommands:this.props.enableCommands,enableOAuthServiceProvider:this.props.enableOAuthServiceProvider,canCreateOrDeleteCustomEmoji:this.props.canCreateOrDeleteCustomEmoji,canManageIntegrations:this.props.canManageIntegrations}),m.createElement(n.rs,null,m.createElement(os,{extraProps:e,exact:!0,path:"/:team/integrations",component:Ae}),m.createElement(os,{extraProps:e,exact:!0,path:"".concat(this.props.match.url,"/incoming_webhooks"),component:_t}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/incoming_webhooks/add"),component:Rt}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/incoming_webhooks/edit"),component:qt}),m.createElement(os,{extraProps:e,exact:!0,path:"".concat(this.props.match.url,"/outgoing_webhooks"),component:Ft}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/outgoing_webhooks/add"),component:Qt}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/outgoing_webhooks/edit"),component:na}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/commands"),component:Qa}),m.createElement(os,{extraProps:e,exact:!0,path:"".concat(this.props.match.url,"/oauth2-apps"),component:ua}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/oauth2-apps/add"),component:ka}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/oauth2-apps/edit"),component:Ca}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/confirm"),component:Ja}),m.createElement(os,{extraProps:e,exact:!0,path:"/:team/emoji",component:Qe}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/add"),component:at}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/bots/add"),component:ge}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/bots/edit"),component:ge}),m.createElement(os,{extraProps:e,path:"".concat(this.props.match.url,"/bots"),component:K}))))}}ns(rs,"propTypes",{user:u().object,team:u().object,match:u().shape({url:u().string.isRequired}).isRequired,siteName:u().string,enableCustomEmoji:u().bool.isRequired,enableIncomingWebhooks:u().bool.isRequired,enableOutgoingWebhooks:u().bool.isRequired,enableCommands:u().bool.isRequired,enableOAuthServiceProvider:u().bool.isRequired,canCreateOrDeleteCustomEmoji:u().bool.isRequired,canManageIntegrations:u().bool.isRequired});const is=(0,n.EN)((0,s.connect)((function(e){const t=(0,o.ts)(e),a=(0,r.kA)(e),s=(0,i.iE)(e),n=s.SiteName,m="true"===s.EnableCustomEmoji,d="true"===s.EnableIncomingWebhooks,u="true"===s.EnableOutgoingWebhooks,p="true"===s.EnableCommands,h="true"===s.EnableOAuthServiceProvider;let g=(0,l.AN)(e,{permission:c.Pl.CREATE_EMOJIS})||(0,l.AN)(e,{permission:c.Pl.DELETE_EMOJIS});if(!g)for(const t of(0,r.Dc)(e))if((0,l.Rm)(e,t.id,c.Pl.CREATE_EMOJIS)||(0,l.Rm)(e,t.id,c.Pl.DELETE_EMOJIS)){g=!0;break}const b=(0,l.Rm)(e,"",c.Pl.MANAGE_SLASH_COMMANDS)||(0,l.Rm)(e,"",c.Pl.MANAGE_OAUTH)||(0,l.Rm)(e,"",c.Pl.MANAGE_INCOMING_WEBHOOKS)||(0,l.Rm)(e,"",c.Pl.MANAGE_OUTGOING_WEBHOOKS),f=(0,l.AN)(e,{permission:c.Pl.MANAGE_BOTS})||(0,l.AN)(e,{permission:c.Pl.MANAGE_OTHERS_BOTS});return{user:t,team:a,siteName:n,enableCustomEmoji:m,enableIncomingWebhooks:d,enableOutgoingWebhooks:u,enableCommands:p,enableOAuthServiceProvider:h,canCreateOrDeleteCustomEmoji:g,canManageIntegrations:b||f}}))(rs))},37668:(e,t,a)=>{a.d(t,{Z:()=>c});var s=a(45697),n=a.n(s),o=a(67294),r=a(68492),i=a(82251);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class c extends o.PureComponent{render(){const e="fa fa-warning"+(this.props.additionalClassName?" "+this.props.additionalClassName:"");return o.createElement(r.Z,{className:e,title:{id:(0,i.t)("generic_icons.warning"),defaultMessage:"Warning Icon"}})}}l(c,"propTypes",{additionalClassName:n().oneOfType([n().string,n().oneOf([null])])}),l(c,"defaultProps",{additionalClassName:null})},45341:(e,t,a)=>{a.d(t,{lz:()=>r,XI:()=>i,l5:()=>l,Uc:()=>c,PZ:()=>m});var s=a(53473),n=a(7039),o=a(28399);function r(e){return(0,o.Vs)({clientFunc:s.je.createBot,onSuccess:n.Jv.RECEIVED_BOT_ACCOUNT,params:[e]})}function i(e,t){return(0,o.Vs)({clientFunc:s.je.patchBot,onSuccess:n.Jv.RECEIVED_BOT_ACCOUNT,params:[e,t]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(0,o.Vs)({clientFunc:s.je.getBotsIncludeDeleted,onSuccess:n.Jv.RECEIVED_BOT_ACCOUNTS,params:[e,t]})}function c(e){return(0,o.Vs)({clientFunc:s.je.disableBot,onSuccess:n.Jv.RECEIVED_BOT_ACCOUNT,params:[e]})}function m(e){return(0,o.Vs)({clientFunc:s.je.enableBot,onSuccess:n.Jv.RECEIVED_BOT_ACCOUNT,params:[e]})}},71436:(e,t,a)=>{a.d(t,{Gb:()=>r,Zh:()=>i});var s=a(39346),n=a(61505);const o=["mattermost-advisor"];function r(e){return e.entities.bots.accounts}const i=(0,s.P1)("getExternalBotAccounts",r,n.Rf,((e,t)=>{const a={};return Object.values(e).forEach((e=>{const s=t[e.user_id];s&&!o.includes(s.username)&&(a[e.user_id]=e)})),a}))}}]);
//# sourceMappingURL=396.0c009a996d05f7bb767b.js.map